## 第3章 オブジェクト指向の考え方 - Part E: 演算子と式

### 3.2 演算子

数値の計算や、文字列の連結など、さまざまな場所で演算子を使った処理を行います。  
すべての演算子が今すぐ使うものではありません。
いつ使うのか分からない演算子も、こういった書き方もできるということを覚えておきましょう。

#### 代入演算子

変数へ値を代入するには、 `=` を使用します。

例：変数に代入を行う場合（aという変数に5を代入する）

```java
a = 5;
```

左辺に対して、右辺を代入します。逆はできません。

次は文法上可能ですが、あまり好ましくない例です。

```java
a = b = 5;
```

とすると、aには「b=5」が代入されるのですが、このとき「b=5」の処理結果は、5を返すため、a,bどちらにも5が代入されます。  
この書き方をたまにすることがありますが、本来ならコードを見た時に認識しづらい書き方だと思われるので極力使わないようにしましょう。

#### 算術演算子

算術演算子には、以下のものがあります。

| 演算子記号 | 役割 | 算出時の優先順位
|----------|------|----|
| `+` | 足し算(加法演算子) | 後
| `-` | 引き算(加法演算子) | 後
| `*` | 掛け算(乗法演算子) | 先
| `/` | 割り算(乗法演算子) | 先
| `%` | 余り(乗法演算子) | 先

##### 算術演算子サンプルプログラム

算術演算子は、プログラミングの基本中の基本であり、数学的な計算、データ解析、アルゴリズムの実装など、あらゆるプログラムで使用されます。以下のプログラムは、Javaの基本的な算術演算子の動作を確認し、整数型の演算がどのように実行されるかを理解するための重要な学習材料です：

ファイル名： ArithmeticSample.java
```java
class ArithmeticSample {
  public static void main(String[] args) {
    int num1 = 10;
    int num2 = 5;

    System.out.println("num1とnum2にいろいろな演算を行います。");
    System.out.println("num1 + num2は" + (num1 + num2) + "です。");
    System.out.println("num1 - num2は" + (num1 - num2) + "です。");
    System.out.println("num1 * num2は" + (num1 * num2) + "です。");
    System.out.println("num1 / num2は" + (num1 / num2) + "です。");
    System.out.println("num1 % num2は" + (num1 % num2) + "です。");
  }
}
```

**このプログラムから学ぶ重要な数学的概念と演算特性：**

1. **整数除算の特性**：`num1 / num2`（10 / 5）の結果は2となりますが、これは整数どうしの除算では小数点以下が切り捨てられるためです。たとえば、num1を3、num2を2に変更すると、3 / 2 = 1（数学的には1.5）となります。

2. **剰余演算の重要性**：`%`演算子（モジュロ演算）は、プログラミングで非常に有用で、偶数・奇数の判定、循環処理の制御、ハッシュテーブルのインデックス計算などで頻繁に使用されます。

3. **演算子優先度の実践**：コード内の`(num1 + num2)`のような括弧は、文字列連結よりも先に算術演算を実行させるために必要です。括弧がないと、文字列連結が優先されて意図しない結果になります。

4. **型安全性とオーバーフロー**：int型の範囲内での演算である限り、このプログラムは安全に実行されます。しかし、很大きな数値を使用する場合は、オーバーフローの可能性を考慮する必要があります。

5. **コードの可読性とデバッグ**：各演算を個別のSytem.out.println文で出力することで、各演算の結果を個別に確認でき、デバッグや動作確認が容易になっています。

**学習のための発展的な実験：**

このプログラムを実行して基本動作を確認した後、以下のような値で実験してみることをお勧めします：

- **整数除算の特性理解**：num1=7, num2=3（7/3=2, 7%3=1）
- **負の数での演算**：num1=-10, num2=3（負の数の剰余演算の理解）
- **ゼロ除算のエラー**：num2=0に設定して、ArithmeticExceptionの発生を確認
- **大きな数値でのオーバーフロー**：num1=Integer.MAX_VALUE, num2=1での加算

これらの実験を通じて、Javaの数値演算の特性と限界を深く理解し、実際のプログラム開発で注意すべきポイントを学ぶことができます。

#### 算術演算を伴う代入演算子（再帰代入演算子）

左辺に対して、右辺との算術演算を行った後に、左辺に代入する処理を省略して書くことができます。

| 演算子記号 | 役割 | 同じ処理で違う書き方
|----------|------|----|
| `+=` | 左辺に右辺を足し算した後に左辺へ代入 | `x += 5;`, `x = x + 5;`
| `-=` | 左辺に右辺を引き算した後に左辺へ代入 | `x -= 5;`, `x = x - 5;`
| `*=` | 左辺に右辺を掛け算した後に左辺へ代入 | `x *= 5;`, `x = x * 5;`
| `/=` | 左辺に右辺を割り算した後に左辺へ代入 | `x /= 5;`, `x = x / 5;`
| `%=` | 左辺に右辺の値で余りを算出した後に左辺へ代入 | `x %= 5;`, `x = x % 5;`

#### 比較演算子

※両辺を比較する場合に使用し、演算子の結果はboolean型で戻ってきます。

| 演算子 | 例 | 説明
|----------|------|------|
| `==` | `a == b` | aとbが等しいときtrue
| `!=` | `a != b` | aとbが等しくないときtrue
| `>` | `a > b` | aがbより大きいときtrue
| `<` | `a < b` | aがbより小さいきとtrue
| `>=` | `a >= b` | aがb以上のときtrue
| `<=` | `a <= b` | aがb以下のときtrue

#### 論理演算子(ショートサーキット演算子)

※両辺ともbooleanの場合に使用します。

| 演算子 | 例 | 説明
|----------|------|------|
| `&&` | `a && b` | aとbの両方がtrueのときtrue
| `||` | `a || b` | aとbのどちらかがtrueのときtrue
| `!` | `!a` | aがfalseのときtrue。逆になる

#### インクリメント・デクリメント

インクリメント・デクリメントの演算子は、それぞれ2種類ずつあります。
この演算子を式中で使う場合、この違いがとても大きく、間違えやすい点ですので、注意が必要です。

##### インクリメント

| 演算子(位置に注意) | 式中で行われるものと同義のステートメント | 式中での評価、更新順序
|------|------|------|
| `y++` | `y = y + 1;` | y を評価してから式を演算し、 y + 1 に更新
| `++y` | `y = y + 1;` | y + 1 に更新してから式の評価、演算

##### デクリメント

| 演算子(位置に注意) | 式中で行われるものと同義のステートメント | 式中での評価、更新順序
|------|------|------|
| `y--` | `y = y - 1;` | y を評価してから式を演算し、 y - 1 に更新
| `--y` | `y = y - 1;` | y - 1 に更新してから式の評価、演算

#### データ型による演算の制約

演算時の注意点として、データ型による丸めの発生があります。

- 整数型どうしの除算は、小数点以下切り捨て
    + 10 / 4 = 2
- どちらかに浮動小数点型の数値がある場合は、小数点以下も計算されます。
    + 10.0 / 4 = 2.5
    + この場合、計算結果は浮動小数点型となります。

#### キャスト演算子

整数型の変数に、浮動小数点型の数値を代入しようとするとエラーとなります。

浮動小数点数を整数に***強制的に変換***し、代入をすればエラーとなりません。  
ただし、整数型に型の強制変換を行ったタイミングで、小数点以下の値は切り捨てられてしまうので注意が必要です。

```java
float s = 1234.567f;
int num = (int)s; // ← numには、1234 が代入される
```

#### 文字列との連結

`+` を使います。

```
"Hello, " + "World!!" → "Hello, World!!"
```

次のプログラムはどのような結果を出力するでしょう？

```java
int a = 3;
int b = 5;
System.out.println("文字列と数値を結合すると..." + a + b);
```

出力結果：

```bash
文字列と数値を結合すると...35
```

基本的には、式中に文字列がある場合、その式が返す値はすべて文字列になります（ただし、括弧などにより、数値の演算のみを優先的に行うことは可能です）。
数値は暗黙的に文字列へ変換されてしまいます。
表示結果をコントロールしたい場合は、この暗黙的な型変換に注意してください。



次のパート：[Part F - 制御構造](chapter03f-control-structures.md)
