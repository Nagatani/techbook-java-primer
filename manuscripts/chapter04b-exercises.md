# 第4章 クラスとインスタンス - Part B: 章末演習

## 章末演習

本章で学んだカプセル化、アクセス制御、クラス設計の概念を段階的に実践し、実用的なクラス設計能力を身につけましょう。各レベルは前のレベルの習得を前提として設計されています。

### 演習の目標
- カプセル化の適切な実装
- アクセス修飾子の正しい使用
- getter/setterパターンの実践
- 入力検証とデータ整合性の確保
- 複数クラス間の連携設計

### 演習課題の難易度レベル

#### 基礎レベル（Basic）
- **目的**: カプセル化とアクセス制御の基本概念の確実な理解
- **所要時間**: 25-40分/課題
- **前提**: 第3章のクラス設計を理解していること
- **評価基準**: 
  - privateフィールドとpublicメソッドの適切な使い分け
  - 基本的な入力検証の実装
  - getter/setterの正しい実装
  - データの整合性を保つ設計

#### 応用レベル（Applied）
- **目的**: より実践的なクラス設計と複数クラス間の連携
- **所要時間**: 40-60分/課題
- **前提**: 基礎レベルを完了していること
- **評価基準**:
  - 複数クラスを適切に連携させた設計
  - ビジネスロジックの適切な配置
  - より高度な入力検証とエラーハンドリング
  - 保守性を考慮した設計

#### 発展レベル（Advanced）
- **目的**: 設計原則にもとづいた高品質なクラス設計
- **所要時間**: 60-80分/課題
- **前提**: 応用レベルを完了し、設計原則に興味があること
- **評価基準**:
  - SOLID原則を意識した設計
  - デザインパターンの適用
  - 拡張性と保守性を考慮した設計
  - パフォーマンスを意識した実装

#### 挑戦レベル（Challenge）
- **目的**: 実務レベルの複雑なシステム設計
- **所要時間**: 80分以上
- **前提**: 発展レベル完了と深い設計への関心
- **評価基準**:
  - 複雑なドメインモデルの設計
  - アーキテクチャパターンの適用
  - テスタビリティを考慮した設計
  - ドキュメント化されたコード

### 演習課題の詳細

演習課題の完全な解答例とテストファイルは `exercises/chapter04/` ディレクトリにあります。
以下では各課題の問題内容、要求仕様、実装ヒントを示します。

## 基礎レベル課題（必須）

### 課題1: 書籍管理クラス（Book.java）

**学習目標：** カプセル化、入力検証、getter/setter

**問題説明：**
書籍の情報を管理するBookクラスを作成し、適切なカプセル化と入力検証を実装してください。

**要求仕様：**
1. プライベートフィールド：`title`（String）、`author`（String）、`isbn`（String）、`price`（double）、`stock`（int）
2. コンストラクタ：全フィールドを初期化（適切な検証を含む）
3. getter/setterメソッド：すべてのフィールドに対して
4. `displayInfo()`メソッド：書籍情報を整理して表示
5. 入力検証：価格は正の値、在庫は0以上、ISBNは13桁

**実行例：**
```
=== 書籍管理システム ===
ISBN: 9784797386295
タイトル: Java入門
著者: 山田太郎
価格: 3200円
在庫: 15冊

在庫更新: 15 → 12
価格更新: 3200円 → 2800円
更新後の書籍情報:
ISBN: 9784797386295
タイトル: Java入門
著者: 山田太郎
価格: 2800円
在庫: 12冊
```

**実装ヒント：**
```java
public class Book {
    private String title;
    private String author;
    private String isbn;
    private double price;
    private int stock;
    
    public Book(String title, String author, String isbn, double price, int stock) {
        setTitle(title);
        setAuthor(author);
        setIsbn(isbn);
        setPrice(price);
        setStock(stock);
    }
    
    // ISBNの検証付きsetter
    public void setIsbn(String isbn) {
        if (isbn == null || isbn.replaceAll("[^0-9]", "").length() != 13) {
            throw new IllegalArgumentException("ISBNは13桁の数字である必要があります");
        }
        this.isbn = isbn;
    }
    
    // 価格の検証付きsetter
    public void setPrice(double price) {
        if (price <= 0) {
            throw new IllegalArgumentException("価格は正の値である必要があります");
        }
        this.price = price;
    }
    
    // 在庫の検証付きsetter
    public void setStock(int stock) {
        if (stock < 0) {
            throw new IllegalArgumentException("在庫は0以上である必要があります");
        }
        this.stock = stock;
    }
    
    public void displayInfo() {
        System.out.println("ISBN: " + isbn);
        System.out.println("タイトル: " + title);
        System.out.println("著者: " + author);
        System.out.println("価格: " + (int)price + "円");
        System.out.println("在庫: " + stock + "冊");
    }
}
```

**評価基準：**
- [ ] 適切なカプセル化（privateフィールド）
- [ ] コンストラクタでの初期化と検証
- [ ] 全フィールドのgetter/setter実装
- [ ] 入力検証の適切な実装
- [ ] 情報表示メソッドの実装

---

### 課題2: 製品管理クラス（Product.java）

**学習目標：** より複雑なビジネスロジック、カテゴリ管理

**問題説明：**
製品の情報を管理するProductクラスを作成し、価格計算と在庫管理のロジックを実装してください。

**要求仕様：**
1. フィールド：`productId`、`name`、`category`、`basePrice`、`discountRate`、`stock`
2. 割り引き適用後の価格計算メソッド
3. 在庫管理メソッド（追加、削除、確認）
4. カテゴリごとの税率適用（食品:8%、その他:10%）
5. 商品情報の詳細表示

**実装のポイント：**
- カテゴリはenum型で管理すると良い
- 価格計算は税率と割り引き率の両方を考慮
- 在庫操作時の検証を忘れずに

---

## 応用レベル課題

### 課題3: 従業員管理システム（Employee.java, Department.java）

**学習目標：** 複数クラスの連携、集約関係の実装

**問題説明：**
従業員と部署の関係を表現する2つのクラスを作成し、組織構造を管理するシステムを実装してください。

**要求仕様：**
1. Employeeクラス：従業員情報（ID、名前、給与、入社日）
2. Departmentクラス：部署情報（部署名、従業員リスト、予算）
3. 部署への従業員の追加・削除機能
4. 部署の給与総額計算
5. 予算超過チェック機能

**設計の注意点：**
- 循環参照を避ける設計
- 責任の適切な分離
- nullチェックとエラーハンドリング

---

### 課題4: 予約管理システム（Reservation.java, Room.java, Guest.java）

**学習目標：** 3つ以上のクラス連携、日付処理、状態管理

**問題説明：**
ホテルの予約管理システムを実装してください。部屋、ゲスト、予約の3つのエンティティを管理します。

**要求仕様：**
1. 各クラスの基本機能実装
2. 予約の重複チェック
3. 料金計算（シーズン料金対応）
4. 予約状態の管理（予約済み、チェックイン、チェックアウト）

---

## 発展レベル課題

### 課題5: 在庫管理システム with デザインパターン

**学習目標：** Observerパターン、Strategyパターンの適用

**問題説明：**
在庫の変動を監視し、自動発注を行うシステムを実装してください。

**設計要件：**
- Observer：在庫変動の通知システム
- Strategy：発注戦略の切り替え（定量発注、定期発注）
- 発注履歴の管理

---

## 挑戦レベル課題

### 課題6: 図書館管理システム

**学習目標：** 実務レベルの複雑なドメインモデル設計

**問題説明：**
図書館の蔵書管理、貸出管理、利用者管理を統合したシステムを設計・実装してください。

**要求機能：**
1. 蔵書検索（タイトル、著者、ISBN）
2. 貸出・返却処理
3. 延滞管理と罰金計算
4. 予約機能
5. 利用者の貸出履歴管理

**設計の考慮点：**
- トランザクション的な処理の実装
- データの整合性保証
- 拡張性を考慮した設計
- エラーハンドリングの充実

---

### 演習を通じて身につくスキル

1. **設計力**: 要求から適切なクラス構造を導き出す能力
2. **実装力**: 設計を正確にコードに落とし込む能力
3. **品質意識**: バグの少ない堅牢なコードを書く習慣
4. **保守性**: 将来の変更に強い設計を行う視点

各課題は段階的に難易度が上がるよう設計されています。基礎レベルから始めて、確実にスキルを積み上げていくことをお勧めします。解答例を参照する前に、まず自分で設計・実装を試みることが重要です。