# 第2章 Java基本文法 - Part A: Javaの基礎

## 始めに：Javaという言語の特徴

本章では、プログラミング言語Javaの基本文法を学習します。Javaは1995年にSun Microsystems（現Oracle）によって発表され、現在も世界中で広く使用されている主要なプログラミング言語の1つです。

### Javaの誕生と基本思想

Javaは「Write Once, Run Anywhere（一度書けば、どこでも動く）」という革新的な思想のもとに設計されました。これは、Java仮想マシン（JVM）という実行環境上でプログラムを動作させることで実現されています。C言語のように特定のハードウェアやOSに依存せず、JVMさえあればWindows、macOS、Linuxなど、どの環境でも同じプログラムが動作します。

### Java仮想マシン（JVM）の主要な特徴

JVMは、Javaプログラムの実行環境として、従来のコンパイル型言語にはない革新的な機能を提供します。最も重要な特徴は**プラットフォーム独立性**です。JavaソースコードはJavaコンパイラによってバイトコードと呼ばれる中間言語に変換され、このバイトコードがJVM上で実行されます。これにより、OSやハードウェアの違いを意識することなく、同じプログラムをさまざまな環境で動作させることができます。

もう1つの重要な特徴は**自動メモリ管理**です。C言語では`malloc()`と`free()`を使って手動でメモリ管理を行う必要がありましたが、Javaではガベージコレクションというしくみにより、使用されなくなったメモリを自動的に解放します。これにより、メモリリークやダングリングポインタといった、C言語プログラミングで頻繁に遭遇する問題から解放されます。

さらに、JVMは**セキュリティ**の面でも優れています。サンドボックス環境と呼ばれる制限された実行環境により、悪意のあるコードがシステムに損害を与えることを防ぎます。また、**実行時最適化**も特筆すべき機能です。JIT（Just-In-Time）コンパイラは、プログラムの実行中に頻繁に使用される部分を検出し、それらをネイティブコードに変換することで、インタプリタ型言語の柔軟性とコンパイル型言語の高速性を両立させています。

### なぜJavaを学ぶのか

Javaは、その誕生から四半世紀以上が経過した現在でも、世界中で最も広く使用されているプログラミング言語の1つです。特に**企業システム開発**の分野では圧倒的な存在感を示しています。銀行のもと幹システム、保険会社の契約管理システム、政府機関の公共サービスシステムなど、私たちの生活を支える重要なインフラストラクチャの多くがJavaで構築されています。これは、Javaが提供する高い信頼性、拡張性、そして長期的なサポートが評価されているためです。

**Webアプリケーション開発**においても、Javaは主要な選択肢の1つです。Spring BootやJakarta EEといった成熟したフレームワークにより、複雑なビジネスロジックを含むWebアプリケーションを効率的に開発できます。また、**モバイル開発**の分野では、AndroidアプリケーションがJavaベースで開発されてきた歴史があり、現在でもKotlinと並んで重要な開発言語となっています。

さらに近年では、**ビッグデータ処理**の分野でもJavaの重要性が増しています。Apache HadoopやApache Sparkといった分散処理フレームワークの多くがJavaで実装されており、大規模データの処理・分析においてJavaの知識は不可欠となっています。

本章では、このような実践的な開発に必要なJavaの基本文法を、C言語との比較を交えながら体系的に学習していきます。

**より詳しい歴史や技術的背景について**：Javaの詳細な歴史、企業システムでの採用事例、オープンソース化の経緯などについては、付録B.01「言語設計とプラットフォーム」を参照してください。

## 2.1 Javaの特徴

Javaがこれほど長期にわたって広く使用されている理由は、言語設計における優れた特徴にあります。最も象徴的な特徴は**プラットフォーム独立性**であり、「Write Once, Run Anywhere（一度書けば、どこでも動く）」というスローガンに集約されています。この特徴により、Windows上で開発したプログラムを、再コンパイルすることなくLinuxやmacOSで実行できます。

Javaは純粋な**オブジェクト指向言語**として設計されています。すべてのコードはクラスの中に記述され、データと処理を一体化したオブジェクトとして扱います。この設計により、大規模なプログラムでも構造化された保守しやすいコードを書くことができます。

**ガベージコレクション**による自動メモリ管理は、プログラマを煩雑なメモリ管理から解放します。C言語でよく発生するメモリリークやセグメンテナンスーション違反といった問題を心配する必要がなくなり、ビジネスロジックの実装に集中できます。

また、Javaは**強い型付け**を採用しており、コンパイル時に多くのエラーを検出できます。これにより、実行時エラーを減らし、より信頼性の高いプログラムを作成できます。さらに、**豊富なライブラリ**エコシステムも大きな魅力です。標準ライブラリだけでなく、Apache Commons、Google Guava、Spring Frameworkなど、数多くの高品質なサードパーティライブラリが利用可能です。

## メモリ管理とガベージコレクション

Javaの最も重要な特徴の1つは、自動メモリ管理（ガベージコレクション）です。C言語ではプログラマがメモリの確保と解放を手動で行う必要がありましたが、Javaではこれを自動化することで、メモリリークやダングリングポインタなどの問題を防ぎます。

ガベージコレクションは世代別仮説にもとづいて効率的に動作し、現代のJVMではG1 GCやZGCなどの低遅延コレクタにより、大規模なアプリケーションでも実用的なパフォーマンスを実現しています。

**メモリ管理の詳細、GCアルゴリズム、パフォーマンスチューニングについては、付録B.02「メモリ管理とパフォーマンス」を参照してください。**

## 2.2 基本データ型

Javaのデータ型システムは、プログラムの安全性と効率性を両立させるよう慎重に設計されています。Javaには8つの基本データ型（プリミティブ型）があり、これらは数値、文字、真偽値を表現するための基本的な構成要素です。C言語と比較すると、型のサイズがプラットフォームに依存しないという重要な違いがあります。

### なぜ異なるサイズの整数型が必要なのか

実際のプログラミングでは、扱うデータの範囲と使用するメモリ量のトレードオフを考慮して適切な型を選択する必要があります。例えば、人の年齢を表すのに`long`型（8バイト）を使うのは無駄ですし、逆に国の人口を`byte`型で表すことはできません。以下のコード例では、各基本データ型の宣言と、それぞれの実用的な使用場面を示します：

```java
// 整数型の使い分け例
byte age = 25;                    // 年齢（0〜127歳で十分）
short temperatureCelsius = -273;  // 温度（絶対零度から数千度まで）
int tokyoPopulation = 14000000;   // 東京都の人口（約1400万人）
long worldPopulation = 8000000000L; // 世界人口（約80億人、intでは表現不可）

// 浮動小数点型の使い分け例
float productPrice = 1980.50f;    // 商品価格（精度7桁で十分な場合）
double piValue = 3.14159265359;   // 円周率（高精度が必要な科学計算）

// その他の型の実用例
char grade = 'A';                 // 成績評価（A, B, C...）
boolean isStudent = true;         // 学生かどうかのフラグ
```

**実際の開発での型選択の指針**：
- **メモリ効率が重要な場合**：配列やコレクションで大量のデータを扱う場合は、適切な最小サイズの型を選択
- **計算精度が重要な場合**：金融計算では`BigDecimal`、科学計算では`double`を使用
- **可読性を優先する場合**：特別な理由がない限り、整数は`int`、小数は`double`を使用するのが一般的

**重要な違い（C言語との比較）**：
- `char`型は16ビット（Unicode対応）
- `boolean`型は`true`/`false`のみ（0/1ではない）
- 各型のサイズは環境によらず固定

## 2.3 変数の宣言と初期化

Javaでは、すべての変数は使用前に宣言する必要があり、型の明示が必須です。これはC言語と同様ですが、Javaはより厳格な初期化ルールを持っています。ローカル変数は明示的に初期化しないと使用できません。また、`final`キーワードを使用することで、一度だけ値を設定できる定数を作成できます。以下の例で、さまざまな変数宣言のパターンを示します：

```java
// 宣言と同時に初期化
int count = 0;
String message = "Hello";

// 宣言後に初期化
double price;
price = 100.0;

// 定数の宣言（finalキーワード）
final double PI = 3.14159265359;
```

## 2.4 演算子

Javaの演算子体系は、C言語の演算子をベースにしていますが、型安全性を高めるためのいくつかの重要な改良が加えられています。特に注目すべきは、論理演算子における短絡評価の明確な仕様化と、文字列連結演算子（`+`）のオーバーロードです。以下のコード例では、Javaで利用可能な主要な演算子とその動作を示します：

```java
// 算術演算子
int a = 10, b = 3;
int sum = a + b;      // 13
int diff = a - b;     // 7
int prod = a * b;     // 30
int quot = a / b;     // 3（整数除算）
int rem = a % b;      // 1（剰余）

// インクリメント・デクリメント
int x = 5;
int y = x++;  // y = 5, x = 6（後置）
int z = ++x;  // z = 7, x = 7（前置）

// 比較演算子
boolean result1 = (a > b);   // true
boolean result2 = (a == b);  // false
boolean result3 = (a != b);  // true

// 論理演算子
boolean p = true, q = false;
boolean and = p && q;        // false（短絡評価）
boolean or = p || q;         // true（短絡評価）
boolean not = !p;            // false

// ビット演算子
int m = 5;    // 0101
int n = 3;    // 0011
int bitAnd = m & n;  // 0001 = 1
int bitOr = m | n;   // 0111 = 7
int bitXor = m ^ n;  // 0110 = 6
```

## 2.5 型変換

Javaの型変換システムは、プログラムの安全性を保証するために厳格に設計されています。C言語では暗黙的に行われていた多くの型変換が、Javaでは明示的なキャストを要求されます。これは一見煩雑に思えるかもしれませんが、予期しないデータ損失やバグを防ぐ重要なしくみです。型変換には、データの精度を失わない拡たいへん換（widening conversion）と、精度を失う可能性がある縮小変換（narrowing conversion）があります：

```java
// 暗黙的な型変換（拡大変換）
int i = 100;
long l = i;        // OK: int → long
double d = i;      // OK: int → double

// 明示的な型変換（縮小変換）
double pi = 3.14159;
int truncated = (int) pi;  // 3（小数部分は切り捨て）

// 文字列との変換
String str = "123";
int num = Integer.parseInt(str);  // 文字列→整数
String str2 = String.valueOf(num);  // 整数→文字列
```

## 2.6 コンソール入出力

プログラムとユーザーの対話は、多くのアプリケーションにおいて基本的な要素です。Javaでは、標準入出力を扱うためのクラスが`java.lang`パッケージと`java.util`パッケージに用意されています。C言語の`printf()`や`scanf()`に相当する機能を、よりオブジェクト指向的な方法で実現しています。以下の例では、基本的な出力方法と、`Scanner`クラスを使用した入力処理を示します：

```java
import java.util.Scanner;

public class IOExample {
    public static void main(String[] args) {
        // 出力
        System.out.println("Hello, World!");
        System.out.print("改行なし");
        System.out.printf("書式付き出力: %d, %.2f%n", 10, 3.14159);
        
        // 入力
        Scanner scanner = new Scanner(System.in);
        System.out.print("名前を入力: ");
        String name = scanner.nextLine();
        System.out.print("年齢を入力: ");
        int age = scanner.nextInt();
        
        System.out.printf("%sさん（%d歳）、こんにちは！%n", name, age);
        scanner.close();
    }
}
```

---

次のパート：[Part B - 制御構造と配列](chapter02b-control-and-arrays.md)