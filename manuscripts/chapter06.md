# ç¬¬6ç«  ä¾‹å¤–å‡¦ç†

## ğŸ“‹ æœ¬ç« ã®å­¦ç¿’ç›®æ¨™

### å‰æçŸ¥è­˜
- **ç¬¬5ç« ã¾ã§ã®åŸºæœ¬çš„ãªJavaãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°èƒ½åŠ›**ï¼šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘è¨­è¨ˆã®å®Ÿè·µçµŒé¨“
- **è¤‡æ•°ã‚¯ãƒ©ã‚¹ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã®é–‹ç™ºçµŒé¨“**ï¼šä¸­è¦æ¨¡ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆçµŒé¨“
- **ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œæ™‚ã®ã‚¨ãƒ©ãƒ¼çµŒé¨“**ï¼šã‚·ã‚¹ãƒ†ãƒ ã®ä¿¡é ¼æ€§ã«å¯¾ã™ã‚‹é–¢å¿ƒ

### åˆ°é”ç›®æ¨™

#### çŸ¥è­˜ç†è§£ç›®æ¨™
- ä¾‹å¤–å‡¦ç†ã®è¨­è¨ˆæ€æƒ³ã¨åˆ©ç‚¹
- ãƒã‚§ãƒƒã‚¯ä¾‹å¤–ã¨éãƒã‚§ãƒƒã‚¯ä¾‹å¤–ã®é•ã„ã¨ä½¿ã„åˆ†ã‘
- ä¾‹å¤–ã®éšå±¤æ§‹é€ ã®ç†è§£
- try-with-resourcesã®æ„ç¾©ã¨ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†
- ä¾‹å¤–å®‰å…¨æ€§ã®æ¦‚å¿µ

#### æŠ€èƒ½ç¿’å¾—ç›®æ¨™
- try-catch-finallyæ§‹æ–‡ã®é©åˆ‡ãªä½¿ç”¨
- ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã®è¨­è¨ˆã¨å®Ÿè£…
- ä¾‹å¤–ã®é©åˆ‡ãªä¼æ’­ã¨å‡¦ç†
- ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ã‚’å«ã‚€å …ç‰¢ãªã‚³ãƒ¼ãƒ‰ä½œæˆ
- ãƒ­ã‚°è¨˜éŒ²ã¨ãƒ‡ãƒãƒƒã‚°æ‰‹æ³•ã®å®Ÿè·µ

#### åˆ°é”ãƒ¬ãƒ™ãƒ«ã®æŒ‡æ¨™
- [ ] ä¾‹å¤–å‡¦ç†ã‚’é©åˆ‡ã«å«ã‚€ä¿¡é ¼æ€§ã®é«˜ã„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒä½œæˆã§ãã‚‹
- [ ] ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–ã‚’ä½¿ã£ãŸç‹¬è‡ªã®ã‚¨ãƒ©ãƒ¼å‡¦ç†ä½“ç³»ãŒè¨­è¨ˆã§ãã‚‹
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒªã‚½ãƒ¼ã‚¹ã‚’å®‰å…¨ã«æ‰±ã†ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå®Ÿè£…ã§ãã‚‹
- [ ] ä¾‹å¤–ãƒ­ã‚°ã®åˆ†æã¨ãƒ‡ãƒãƒƒã‚°ãŒã§ãã‚‹

---

## å§‹ã‚ã«ï¼šãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä¿¡é ¼æ€§ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®é€²åŒ–

å‰ç« ã¾ã§ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®åŸºæœ¬æ¦‚å¿µã¨Javaã®ä¸»è¦ãªæ©Ÿèƒ½ã«ã¤ã„ã¦å­¦ç¿’ã—ã¦ãã¾ã—ãŸã€‚æœ¬ç« ã§ã¯ã€ç¾å®Ÿä¸–ç•Œã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã«ãŠã„ã¦æ¥µã‚ã¦é‡è¦ãªã€Œä¾‹å¤–å‡¦ç†ï¼ˆException Handlingï¼‰ã€ã«ã¤ã„ã¦è©³ç´°ã«å­¦ç¿’ã—ã¾ã™ã€‚

ä¾‹å¤–å‡¦ç†ã¯å˜ãªã‚‹æŠ€è¡“çš„ãªä»•çµ„ã¿ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œä¸­ã«ç™ºç”Ÿã™ã‚‹äºˆæœŸã—ãªã„çŠ¶æ³ã‚„ç•°å¸¸äº‹æ…‹ã‚’é©åˆ‡ã«ç®¡ç†ã—ã€ã‚·ã‚¹ãƒ†ãƒ ã®å®‰å®šæ€§ã¨ä¿¡é ¼æ€§ã‚’ç¢ºä¿ã™ã‚‹ãŸã‚ã®ã€ç¾ä»£çš„ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã«ãŠã‘ã‚‹å¿…é ˆã®è¨­è¨ˆåŸå‰‡ã§ã™ã€‚

### ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã«ãŠã‘ã‚‹ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ­´å²

ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æ­´å²ã«ãŠã„ã¦ã€ã€Œã‚¨ãƒ©ãƒ¼å‡¦ç†ã€ã¯å¸¸ã«é–‹ç™ºè€…ã‚’æ‚©ã¾ã›ã‚‹é‡è¦ãªèª²é¡Œã§ã—ãŸã€‚åˆæœŸã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã§ã¯ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã®å¯¾å‡¦æ³•ã¯é™å®šçš„ã§ã€å¤šãã®å ´åˆã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ã‹ã€äºˆæœŸã—ãªã„å‹•ä½œã‚’ç¤ºã™ã—ã‹ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚

**1950å¹´ä»£ã€œ1960å¹´ä»£ã®çŠ¶æ³**ï¼šåˆæœŸã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªï¼ˆFORTRANã€COBOLãªã©ï¼‰ã§ã¯ã€ã‚¨ãƒ©ãƒ¼å‡¦ç†ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒå€‹äººã®è²¬ä»»ã§ã‚ã‚Šã€çµ±ä¸€ã•ã‚ŒãŸæ–¹æ³•è«–ã¯å­˜åœ¨ã—ã¾ã›ã‚“ã§ã—ãŸã€‚ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢éšœå®³ã‚„ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã¨ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯åœæ­¢ã—ã€å ´åˆã«ã‚ˆã£ã¦ã¯ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ã¾ã—ãŸã€‚

**1970å¹´ä»£ã®æ§‹é€ åŒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°**ï¼šCè¨€èªãªã©ã®æ§‹é€ åŒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã§ã¯ã€é–¢æ•°ã®æˆ»ã‚Šå€¤ã‚’ä½¿ç”¨ã—ã¦ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã‚’ç¤ºã™ã¨ã„ã†æ‰‹æ³•ãŒä¸€èˆ¬çš„ã«ãªã‚Šã¾ã—ãŸã€‚ã—ã‹ã—ã€ã“ã®æ–¹æ³•ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå•é¡ŒãŒã‚ã‚Šã¾ã—ãŸï¼š

- ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ãŒç…©é›‘ã§ã€æ­£å¸¸ãªå‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯ã¨ã‚¨ãƒ©ãƒ¼å‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯ãŒæ··åœ¨ã™ã‚‹
- ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ã‚’å¿˜ã‚Œã‚„ã™ãã€æœªå‡¦ç†ã®ã‚¨ãƒ©ãƒ¼ãŒãƒ—ãƒ­ã‚°ãƒ©ãƒ å…¨ä½“ã«æ‚ªå½±éŸ¿ã‚’ä¸ãˆã‚‹
- è¤‡æ•°ã®é–¢æ•°ã‚’é€šã˜ã¦ã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚’ä¼æ’­ã•ã›ã‚‹ã“ã¨ãŒå›°é›£
- ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã‚„è©³ç´°ãªæƒ…å ±ã‚’ä¼é”ã™ã‚‹æ¨™æº–çš„ãªæ–¹æ³•ãŒä¸è¶³

### ä¾‹å¤–å‡¦ç†ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã®èª•ç”Ÿ

ã“ã‚Œã‚‰ã®å•é¡Œã‚’æ ¹æœ¬çš„ã«è§£æ±ºã™ã‚‹ãŸã‚ã€1980å¹´ä»£ã‹ã‚‰1990å¹´ä»£ã«ã‹ã‘ã¦ã€ã€Œä¾‹å¤–å‡¦ç†ã€ã¨ã„ã†æ–°ã—ã„ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ãŒç ”ç©¶ãƒ»é–‹ç™ºã•ã‚Œã¾ã—ãŸã€‚ä¾‹å¤–å‡¦ç†ã®åŸºæœ¬çš„ãªæ€æƒ³ã¯ã€ã€Œæ­£å¸¸ãªå‡¦ç†ã®æµã‚Œã€ã¨ã€Œç•°å¸¸äº‹æ…‹ã¸ã®å¯¾å‡¦ã€ã‚’æ˜ç¢ºã«åˆ†é›¢ã—ã€ã‚ˆã‚Šç›´æ„Ÿçš„ã§ä¿å®ˆæ€§ã®é«˜ã„ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿç¾ã™ã‚‹ã“ã¨ã§ã™ã€‚

**Adaè¨€èªï¼ˆ1980å¹´ä»£ï¼‰**ï¼šè»äº‹ãƒ»èˆªç©ºå®‡å®™åˆ†é‡ã§ã®ä½¿ç”¨ã‚’æƒ³å®šã—ã¦é–‹ç™ºã•ã‚ŒãŸAdaè¨€èªã¯ã€åˆæœŸã®æ§‹é€ åŒ–ä¾‹å¤–å‡¦ç†æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã—ãŸã€‚é«˜ã„ä¿¡é ¼æ€§ãŒè¦æ±‚ã•ã‚Œã‚‹ã‚·ã‚¹ãƒ†ãƒ ã§ã®ä½¿ç”¨ã‚’å‰æã¨ã—ã¦ã€å …ç‰¢ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ©Ÿèƒ½ãŒè¨­è¨ˆã•ã‚Œã¾ã—ãŸã€‚

**C++ï¼ˆ1990å¹´ä»£ï¼‰**ï¼šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®æ™®åŠã¨ã¨ã‚‚ã«ã€C++ã«ä¾‹å¤–å‡¦ç†æ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚tryã€catchã€throwã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ä¾‹å¤–å‡¦ç†ã®åŸºæœ¬çš„ãªæ§‹é€ ãŒç¢ºç«‹ã•ã‚Œã¾ã—ãŸã€‚

**Javaï¼ˆ1995å¹´ï¼‰**ï¼šJavaã¯ã€ä¾‹å¤–å‡¦ç†ã‚’è¨€èªã®ä¸­æ ¸çš„ãªæ©Ÿèƒ½ã¨ã—ã¦çµ±åˆã—ã€æ¤œæŸ»ä¾‹å¤–ï¼ˆchecked exceptionï¼‰ã¨ã„ã†ç‹¬è‡ªã®æ¦‚å¿µã‚’å°å…¥ã—ã¾ã—ãŸã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å¦¥å½“æ€§ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€ã‚ˆã‚Šå®‰å…¨ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚

### Javaã®ä¾‹å¤–å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ã®é©æ–°æ€§

Javaã®ä¾‹å¤–å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ã»ã‹ã®è¨€èªã¨æ¯”è¼ƒã—ã¦ä»¥ä¸‹ã®é©æ–°çš„ãªç‰¹å¾´ã‚’æŒã£ã¦ã„ã¾ã™ï¼š

**çµ±ä¸€ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«**ï¼šã™ã¹ã¦ã®ä¾‹å¤–ã¯ã€Throwableã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦è¡¨ç¾ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¨ãƒ©ãƒ¼æƒ…å ±ã®æ§‹é€ åŒ–ã¨ã€çµ±ä¸€ã•ã‚ŒãŸæ–¹æ³•ã§ã®ã‚¨ãƒ©ãƒ¼å‡¦ç†ãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚

**æ¤œæŸ»ä¾‹å¤–ã¨éæ¤œæŸ»ä¾‹å¤–ã®åˆ†é›¢**ï¼šJavaã§ã¯ã€ä¾‹å¤–ã‚’ã€Œæ¤œæŸ»ä¾‹å¤–ï¼ˆChecked Exceptionï¼‰ã€ã¨ã€Œéæ¤œæŸ»ä¾‹å¤–ï¼ˆUnchecked Exceptionï¼‰ã€ã«åˆ†é¡ã—ã€ãã‚Œãã‚Œç•°ãªã‚‹å‡¦ç†æ–¹é‡ã‚’é©ç”¨ã—ã¾ã™ã€‚æ¤œæŸ»ä¾‹å¤–ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒãŒæ˜ç¤ºçš„ã«å‡¦ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«ãƒã‚§ãƒƒã‚¯ã•ã‚Œã¾ã™ã€‚

**ä¾‹å¤–ã®éšå±¤æ§‹é€ **ï¼šã™ã¹ã¦ã®ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã¯éšå±¤çš„ã«çµ„ç¹”åŒ–ã•ã‚Œã¦ãŠã‚Šã€é©åˆ‡ãªæŠ½è±¡åŒ–ãƒ¬ãƒ™ãƒ«ã§ã®ä¾‹å¤–å‡¦ç†ãŒå¯èƒ½ã§ã™ã€‚å…·ä½“çš„ãªã‚¨ãƒ©ãƒ¼ã‹ã‚‰ä¸€èˆ¬çš„ãªã‚¨ãƒ©ãƒ¼ã¾ã§ã€çŠ¶æ³ã«å¿œã˜ã¦é©åˆ‡ãªç²’åº¦ã§ã®å‡¦ç†ãŒã§ãã¾ã™ã€‚

**ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ã¨ã®çµ±åˆ**ï¼štry-with-resourcesæ§‹æ–‡ã«ã‚ˆã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šãªã©ã®ãƒªã‚½ãƒ¼ã‚¹ã®ç¢ºå®Ÿãªè§£æ”¾ã¨ã€ä¾‹å¤–å‡¦ç†ã‚’çµ±åˆã—ãŸå®‰å…¨ãªãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ãŒå®Ÿç¾ã•ã‚Œã¦ã„ã¾ã™ã€‚

### ä¾‹å¤–å‡¦ç†ãŒã‚‚ãŸã‚‰ã™è¨­è¨ˆä¸Šã®åˆ©ç‚¹

é©åˆ‡ã«è¨­è¨ˆã•ã‚ŒãŸä¾‹å¤–å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã«ãŠã„ã¦ä»¥ä¸‹ã®é‡è¦ãªåˆ©ç‚¹ã‚’ã‚‚ãŸã‚‰ã—ã¾ã™ï¼š

**å¯èª­æ€§ã®å‘ä¸Š**ï¼šæ­£å¸¸ãªå‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯ã¨ã‚¨ãƒ©ãƒ¼å‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯ãŒæ˜ç¢ºã«åˆ†é›¢ã•ã‚Œã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä¸»è¦ãªå‡¦ç†ã®æµã‚ŒãŒç†è§£ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚ãƒ¡ã‚½ãƒƒãƒ‰ã®æœ¬æ¥ã®ç›®çš„ã«é›†ä¸­ã§ãã€ã‚³ãƒ¼ãƒ‰ã®æ„å›³ãŒæ˜ç¢ºã«ãªã‚Šã¾ã™ã€‚

**ä¿å®ˆæ€§ã®å‘ä¸Š**ï¼šã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ãŒé›†ç´„ã•ã‚Œã‚‹ã“ã¨ã§ã€ã‚¨ãƒ©ãƒ¼å‡¦ç†ã®æ–¹é‡å¤‰æ›´ã‚„æ”¹å–„ãŒå®¹æ˜“ã«ãªã‚Šã¾ã™ã€‚ã¾ãŸã€æ–°ã—ã„ç¨®é¡ã®ã‚¨ãƒ©ãƒ¼ã¸ã®å¯¾å¿œã‚‚ã€æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã“ã¨ãªãå®Ÿè£…ã§ãã¾ã™ã€‚

**å …ç‰¢æ€§ã®å‘ä¸Š**ï¼šæƒ³å®šå¤–ã®çŠ¶æ³ãŒç™ºç”Ÿã—ã¦ã‚‚ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒé©åˆ‡ã«å¯¾å‡¦ã—ã€å¯èƒ½ãªé™ã‚Šå‡¦ç†ã‚’ç¶™ç¶šã™ã‚‹ã‹ã€å®‰å…¨ã«åœæ­¢ã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®å®‰å®šæ€§ãŒå¤§å¹…ã«å‘ä¸Šã—ã¾ã™ã€‚

**ãƒ‡ãƒãƒƒã‚°ã®åŠ¹ç‡åŒ–**ï¼šä¾‹å¤–ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¯ã€ã‚¨ãƒ©ãƒ¼ã®ç™ºç”Ÿå ´æ‰€ã€åŸå› ã€ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãªã©ã®è©³ç´°ãªæƒ…å ±ãŒå«ã¾ã‚Œã‚‹ãŸã‚ã€å•é¡Œã®ç‰¹å®šã¨ä¿®æ­£ãŒåŠ¹ç‡çš„ã«è¡Œãˆã¾ã™ã€‚

### ç¾ä»£ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã«ãŠã‘ã‚‹ä¾‹å¤–å‡¦ç†ã®é‡è¦æ€§

ç¾ä»£ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã«ãŠã„ã¦ã€ä¾‹å¤–å‡¦ç†ã®é‡è¦æ€§ã¯ã¾ã™ã¾ã™é«˜ã¾ã£ã¦ã„ã¾ã™ï¼š

**åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã®æ™®åŠ**ï¼šãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚„ã‚¯ãƒ©ã‚¦ãƒ‰ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®æ™®åŠã«ã‚ˆã‚Šã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éšœå®³ã‚„ã‚µãƒ¼ãƒ“ã‚¹é–“é€šä¿¡ã‚¨ãƒ©ãƒ¼ãªã©ã€å¾“æ¥ã‚ˆã‚Šã‚‚å¤šæ§˜ã§è¤‡é›‘ãªã‚¨ãƒ©ãƒ¼çŠ¶æ³ã¸ã®å¯¾å‡¦ãŒå¿…è¦ã«ãªã£ã¦ã„ã¾ã™ã€‚

**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®é‡è¦æ€§**ï¼šã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ã®å¤šãã¯ã€é©åˆ‡ã«å‡¦ç†ã•ã‚Œãªã‹ã£ãŸã‚¨ãƒ©ãƒ¼çŠ¶æ³ã«èµ·å› ã—ã¾ã™ã€‚ä¾‹å¤–å‡¦ç†ã«ã‚ˆã‚‹é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ›ãƒ¼ãƒ«ã‚’é˜²ãé‡è¦ãªæ‰‹æ®µã¨ãªã£ã¦ã„ã¾ã™ã€‚

**ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã®å‘ä¸Š**ï¼šç¾ä»£ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã‚‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«åˆ†ã‹ã‚Šã‚„ã™ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã€å¯èƒ½ãªé™ã‚Šå‡¦ç†ã‚’ç¶™ç¶šã™ã‚‹ã“ã¨ãŒæ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚é©åˆ‡ãªä¾‹å¤–å‡¦ç†ã«ã‚ˆã‚Šã€å„ªã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã‚’æä¾›ã§ãã¾ã™ã€‚

**é‹ç”¨ç›£è¦–ã®è‡ªå‹•åŒ–**ï¼šä¾‹å¤–æƒ…å ±ã‚’ãƒ­ã‚°ã‚„ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ã—ã¦åé›†ãƒ»åˆ†æã™ã‚‹ã“ã¨ã§ã€ã‚·ã‚¹ãƒ†ãƒ ã®å¥å…¨æ€§ã‚’ç›£è¦–ã—ã€éšœå®³ã®äºˆå…†ã‚’æ—©æœŸã«ç™ºè¦‹ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã£ã¦ã„ã¾ã™ã€‚

### é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¨ã®çµ±åˆ

è¿‘å¹´ã®Javaé–‹ç™ºã§ã¯ã€å¾“æ¥ã®ä¾‹å¤–å‡¦ç†ã«åŠ ãˆã¦ã€é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®æ¦‚å¿µã‚’å–ã‚Šå…¥ã‚ŒãŸæ–°ã—ã„ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ‰‹æ³•ã‚‚æ³¨ç›®ã•ã‚Œã¦ã„ã¾ã™ï¼š

**Optionalã‚¯ãƒ©ã‚¹**ï¼šnullå‚ç…§ã«ã‚ˆã‚‹ä¾‹å¤–ã‚’å‹ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«ã§é˜²ãä»•çµ„ã¿ã§ã™ã€‚å€¤ã®å­˜åœ¨ãƒ»ä¸å­˜åœ¨ã‚’æ˜ç¤ºçš„ã«è¡¨ç¾ã—ã€ã‚ˆã‚Šå®‰å…¨ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆã‚’æ”¯æ´ã—ã¾ã™ã€‚

**Resultå‹ãƒ‘ã‚¿ãƒ¼ãƒ³**ï¼šæˆåŠŸã¨å¤±æ•—ã‚’å‹ã§è¡¨ç¾ã—ã€ä¾‹å¤–ã‚’ä½¿ç”¨ã›ãšã«ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®å½±éŸ¿ã‚’å—ã‘ãŸã€ã‚ˆã‚Šå®£è¨€çš„ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

**Compleãƒ†ãƒ¼ãƒ–ãƒ«Future**ï¼šéåŒæœŸå‡¦ç†ã«ãŠã‘ã‚‹ä¾‹å¤–å‡¦ç†ã‚’çµ±åˆã—ã€è¤‡é›‘ãªéåŒæœŸãƒ•ãƒ­ãƒ¼ã§ã‚‚ä¸€è²«ã—ãŸã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

### æœ¬ç« ã§å­¦ç¿’ã™ã‚‹å†…å®¹ã®æ„ç¾©

æœ¬ç« ã§ã¯ã€ã“ã‚Œã‚‰ã®æ­´å²çš„èƒŒæ™¯ã¨ç¾ä»£çš„ãªèª²é¡Œã‚’è¸ã¾ãˆã¦ã€Javaã®ä¾‹å¤–å‡¦ç†ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’ä½“ç³»çš„ã«å­¦ç¿’ã—ã¦ã„ãã¾ã™ã€‚å˜ã«æ§‹æ–‡ã‚’è¦šãˆã‚‹ã®ã§ã¯ãªãã€ä»¥ä¸‹ã®ç‚¹ã‚’é‡è¦–ã—ã¦å­¦ç¿’ã‚’é€²ã‚ã¾ã™ï¼š

**è¨­è¨ˆæ€æƒ³ã®ç†è§£**ï¼šãªãœä¾‹å¤–å‡¦ç†ãŒå¿…è¦ãªã®ã‹ã€ã©ã®ã‚ˆã†ãªå ´é¢ã§æœ‰åŠ¹ãªã®ã‹ã‚’ç†è§£ã—ã€é©åˆ‡ãªä¾‹å¤–è¨­è¨ˆãŒã§ãã‚‹èƒ½åŠ›ã‚’èº«ã«ã¤ã‘ã¾ã™ã€‚

**å®Ÿè·µçš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç¿’å¾—**ï¼štry-catch-finallyã€try-with-resourcesã€ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–ãªã©ã€å®Ÿéš›ã®é–‹ç™ºã§é »ç¹ã«ä½¿ç”¨ã•ã‚Œã‚‹ä¾‹å¤–å‡¦ç†ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¿’å¾—ã—ã¾ã™ã€‚

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®è€ƒæ…®**ï¼šä¾‹å¤–å‡¦ç†ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç‰¹æ€§ã‚’ç†è§£ã—ã€é©åˆ‡ãªä½¿ã„åˆ†ã‘ãŒã§ãã‚‹èƒ½åŠ›ã‚’é¤Šã„ã¾ã™ã€‚

**ç¾ä»£çš„ãªé–‹ç™ºæ‰‹æ³•ã¨ã®çµ±åˆ**ï¼šOptionalã€Compleãƒ†ãƒ¼ãƒ–ãƒ«Futureã€ãƒ­ã‚°ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãªã©ã€ç¾ä»£çš„ãªJavaæ©Ÿèƒ½ã¨ã®çµ„ã¿åˆã‚ã›æ–¹ã‚’å­¦ç¿’ã—ã¾ã™ã€‚

**ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£ã®å‘ä¸Š**ï¼šä¾‹å¤–å‡¦ç†ã‚’è€ƒæ…®ã—ãŸãƒ†ã‚¹ãƒˆè¨­è¨ˆã«ã‚ˆã‚Šã€ã‚ˆã‚Šå …ç‰¢ã§ä¿¡é ¼æ€§ã®é«˜ã„ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ä½œæˆã™ã‚‹èƒ½åŠ›ã‚’èº«ã«ã¤ã‘ã¾ã™ã€‚

ä¾‹å¤–å‡¦ç†ã‚’æ·±ãç†è§£ã™ã‚‹ã“ã¨ã¯ã€Javaãƒ—ãƒ­ã‚°ãƒ©ãƒã¨ã—ã¦ã®æŠ€è¡“ãƒ¬ãƒ™ãƒ«ã‚’å‘ä¸Šã•ã›ã‚‹ã ã‘ã§ãªãã€å …ç‰¢ã§ä¿å®ˆæ€§ã®é«˜ã„ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’è¨­è¨ˆã™ã‚‹èƒ½åŠ›ã‚’å¤§å¹…ã«å‘ä¸Šã•ã›ã‚‹ã“ã¨ã«ã¤ãªãŒã‚Šã¾ã™ã€‚æœ¬ç« ã‚’é€šã˜ã¦ã€å˜ãªã‚‹ã€Œã‚¨ãƒ©ãƒ¼ã«å¯¾å‡¦ã™ã‚‹æŠ€è¡“ã€ã‚’è¶…ãˆã¦ã€ã€Œä¿¡é ¼æ€§ã®é«˜ã„ã‚·ã‚¹ãƒ†ãƒ ã‚’è¨­è¨ˆã™ã‚‹æ€æƒ³ã€ã‚’èº«ã«ã¤ã‘ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

æœ¬ç« ã§ã¯ã€Javaã®ä¾‹å¤–å‡¦ç†ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã«ã¤ã„ã¦å­¦ç¿’ã—ã¾ã™ã€‚

## 6.1 ä¾‹å¤–ã®åŸºç¤

### try-catchæ–‡ã®å®Ÿè·µä¾‹ï¼šé›»å“ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

ä¾‹å¤–å‡¦ç†ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚„ã‚·ã‚¹ãƒ†ãƒ ã®äºˆæœŸã—ãªã„çŠ¶æ³ã«å¯¾å‡¦ã™ã‚‹ãŸã‚ã®é‡è¦ãªä»•çµ„ã¿ã§ã™ã€‚ä»¥ä¸‹ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã€é›»å“ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã„ã†å®Ÿç”¨çš„ãªä¾‹ã‚’é€šã˜ã¦ã€åŸºæœ¬çš„ãªä¾‹å¤–å‡¦ç†ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®é‡è¦æ€§ã‚’å­¦ç¿’ã™ã‚‹ãŸã‚ã®ææ–™ã§ã™ï¼š

ãƒ•ã‚¡ã‚¤ãƒ«åï¼š Calculator.java

```java
import java.util.Scanner;
import java.util.InputMismatchException;

public class Calculator {
    private Scanner scanner;
    
    public Calculator() {
        this.scanner = new Scanner(System.in);
    }
    
    // åŸºæœ¬çš„ãªä¾‹å¤–å‡¦ç†ï¼šã‚¼ãƒ­é™¤ç®—ã‚¨ãƒ©ãƒ¼ã®å‡¦ç†
    public double divide(double numerator, double denominator) throws ArithmeticException {
        if (denominator == 0) {
            throw new ArithmeticException("ã‚¼ãƒ­ã§å‰²ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“");
        }
        return numerator / denominator;
    }
    
    // è¤‡æ•°ã®ä¾‹å¤–ã‚’å‡¦ç†ã™ã‚‹åŒ…æ‹¬çš„ãªãƒ¡ã‚½ãƒƒãƒ‰
    public void performCalculation() {
        System.out.println("=== å®‰å…¨ãªé›»å“ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ===");
        
        while (true) {
            try {
                // ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®å–å¾—ï¼ˆæ•°å€¤ä»¥å¤–ãŒå…¥åŠ›ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ï¼‰
                System.out.print("æœ€åˆã®æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆçµ‚äº†ã¯ 'q'ï¼‰: ");
                String firstInput = scanner.next();
                
                // çµ‚äº†æ¡ä»¶ã®ãƒã‚§ãƒƒã‚¯
                if (firstInput.equalsIgnoreCase("q")) {
                    System.out.println("é›»å“ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’çµ‚äº†ã—ã¾ã™ã€‚");
                    break;
                }
                
                double num1 = Double.parseDouble(firstInput); // NumberFormatException ã®å¯èƒ½æ€§
                
                System.out.print("æ¼”ç®—å­ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ (+, -, *, /): ");
                String operator = scanner.next();
                
                System.out.print("2ç•ªç›®ã®æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„: ");
                double num2 = scanner.nextDouble(); // InputMismatchException ã®å¯èƒ½æ€§
                
                double result = 0;
                boolean validOperation = true;
                
                // æ¼”ç®—ã®å®Ÿè¡Œï¼ˆå„æ¼”ç®—ã§ç•°ãªã‚‹ä¾‹å¤–ã®å¯èƒ½æ€§ï¼‰
                switch (operator) {
                    case "+":
                        result = num1 + num2;
                        break;
                    case "-":
                        result = num1 - num2;
                        break;
                    case "*":
                        result = num1 * num2;
                        break;
                    case "/":
                        try {
                            result = divide(num1, num2); // ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–ã®å¯èƒ½æ€§
                        } catch (ArithmeticException e) {
                            System.out.println("è¨ˆç®—ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
                            validOperation = false;
                        }
                        break;
                    default:
                        System.out.println("ç„¡åŠ¹ãªæ¼”ç®—å­ã§ã™: " + operator);
                        validOperation = false;
                }
                
                if (validOperation) {
                    System.out.printf("çµæœ: %.2f %s %.2f = %.2f\n", num1, operator, num2, result);
                    
                    // çµæœã®ç‰¹æ®Šã‚±ãƒ¼ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯
                    if (Double.isInfinite(result)) {
                        System.out.println("è­¦å‘Š: çµæœãŒç„¡é™å¤§ã§ã™");
                    } else if (Double.isNaN(result)) {
                        System.out.println("è­¦å‘Š: çµæœãŒæ•°å€¤ã§ã¯ã‚ã‚Šã¾ã›ã‚“");
                    }
                }
                
            } catch (NumberFormatException e) {
                System.out.println("å…¥åŠ›ã‚¨ãƒ©ãƒ¼: æœ‰åŠ¹ãªæ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
                System.out.println("è©³ç´°: " + e.getMessage());
                
            } catch (InputMismatchException e) {
                System.out.println("å…¥åŠ›ã‚¨ãƒ©ãƒ¼: æ­£ã—ã„å½¢å¼ã§æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
                scanner.nextLine(); // ä¸æ­£ãªå…¥åŠ›ã‚’ã‚¯ãƒªã‚¢
                
            } catch (Exception e) {
                // äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ã‚’ã‚­ãƒ£ãƒƒãƒï¼ˆæœ€å¾Œã®ç ¦ï¼‰
                System.out.println("äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: " + e.getClass().getSimpleName());
                System.out.println("è©³ç´°: " + e.getMessage());
                
                // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®è¡¨ç¤ºï¼ˆé–‹ç™ºæ™‚ã®ã¿ï¼‰
                System.out.println("ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹:");
                e.printStackTrace();
                
            } finally {
                // å‡¦ç†å®Œäº†æ™‚ã®å…±é€šå‡¦ç†
                System.out.println("---");
            }
        }
    }
    
    // ãƒªã‚½ãƒ¼ã‚¹ã®é©åˆ‡ãªè§£æ”¾
    public void cleanup() {
        if (scanner != null) {
            scanner.close();
            System.out.println("ãƒªã‚½ãƒ¼ã‚¹ã‚’è§£æ”¾ã—ã¾ã—ãŸã€‚");
        }
    }
    
    public static void main(String[] args) {
        Calculator calc = new Calculator();
        
        try {
            calc.performCalculation();
        } finally {
            // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã®ç¢ºå®Ÿãªãƒªã‚½ãƒ¼ã‚¹è§£æ”¾
            calc.cleanup();
        }
    }
}
```

**ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰å­¦ã¶é‡è¦ãªä¾‹å¤–å‡¦ç†ã®æ¦‚å¿µï¼š**

1. **å¤šå±¤çš„ãªä¾‹å¤–å‡¦ç†**ï¼šç•°ãªã‚‹ç¨®é¡ã®ä¾‹å¤–ï¼ˆNumberFormatExceptionã€InputMismatchExceptionã€ArithmeticExceptionï¼‰ã‚’é©åˆ‡ã«åˆ†é¡ã—ã€ãã‚Œãã‚Œã«é©ã—ãŸå‡¦ç†ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

2. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**ï¼šæŠ€è¡“çš„ãªã‚¨ãƒ©ãƒ¼è©³ç´°ã‚’é–‹ç™ºè€…å‘ã‘ã«ä¿æŒã—ãªãŒã‚‰ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ç†è§£ã—ã‚„ã™ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

3. **å …ç‰¢æ€§ã®ç¢ºä¿**ï¼š1ã¤ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã‚‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ãŒåœæ­¢ã™ã‚‹ã“ã¨ãªãã€å‡¦ç†ã‚’ç¶™ç¶šã§ãã‚‹è¨­è¨ˆã«ãªã£ã¦ã„ã¾ã™ã€‚

4. **ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†**ï¼šfinallyç¯€ã‚’ä½¿ç”¨ã—ã¦ãƒªã‚½ãƒ¼ã‚¹ã®ç¢ºå®Ÿãªè§£æ”¾ã‚’ä¿è¨¼ã—ã¦ã„ã¾ã™ã€‚

5. **ãƒ‡ãƒãƒƒã‚°æ”¯æ´**ï¼šé–‹ç™ºæ™‚ã«ã¯ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’è¡¨ç¤ºã—ã€å•é¡Œã®ç‰¹å®šã‚’å®¹æ˜“ã«ã—ã¦ã„ã¾ã™ã€‚

**å®Ÿç”¨çš„ãªå¿œç”¨å ´é¢ï¼š**

- **Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®æ¤œè¨¼ã¨ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹**ï¼šæ¥ç¶šã‚¨ãƒ©ãƒ¼ã‚„SQLä¾‹å¤–ã®å‡¦ç†
- **ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†**ï¼šå­˜åœ¨ã—ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚¨ãƒ©ãƒ¼ã®å¯¾å¿œ
- **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡**ï¼šã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚„æ¥ç¶šå¤±æ•—ã®å‡¦ç†

**ä¾‹å¤–å‡¦ç†ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ï¼š**

1. **å…·ä½“çš„ãªä¾‹å¤–ã‹ã‚‰æ±ç”¨çš„ãªä¾‹å¤–ã®é †**ï¼šã‚ˆã‚Šå…·ä½“çš„ãªã‚¨ãƒ©ãƒ¼ã‚’å…ˆã«å‡¦ç†ã—ã€æœ€å¾Œã«æ±ç”¨çš„ãªã‚­ãƒ£ãƒƒãƒã‚’é…ç½®
2. **é©åˆ‡ãªãƒ­ã‚®ãƒ³ã‚°**ï¼šã‚¨ãƒ©ãƒ¼ã®è©³ç´°æƒ…å ±ã‚’é©åˆ‡ã«ãƒ­ã‚°ã«è¨˜éŒ²
3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã®é…æ…®**ï¼šã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã‚‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¬¡ã«ä½•ã‚’ã™ã¹ãã‹ã‚’æ˜ç¢ºã«ã™ã‚‹
4. **ãƒªã‚½ãƒ¼ã‚¹ã®ç¢ºå®Ÿãªè§£æ”¾**ï¼šfinallyç¯€ã‚„try-with-resourcesæ–‡ã«ã‚ˆã‚‹ç¢ºå®Ÿãªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

### è¤‡æ•°ã®ä¾‹å¤–å‡¦ç†ã®å®Ÿè·µä¾‹ï¼šãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æã‚·ã‚¹ãƒ†ãƒ 

è¤‡æ•°ã®ä¾‹å¤–å‡¦ç†ã¯ã€å®Ÿéš›ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã§ã¯éå¸¸ã«é‡è¦ã§ã™ã€‚ä»¥ä¸‹ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ†æã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã¨ã„ã†å®Ÿç”¨çš„ãªä¾‹ã‚’é€šã˜ã¦ã€ã•ã¾ã–ã¾ãªç¨®é¡ã®ä¾‹å¤–ã‚’é©åˆ‡ã«å‡¦ç†ã™ã‚‹æ–¹æ³•ã‚’å­¦ç¿’ã™ã‚‹ãŸã‚ã®ææ–™ã§ã™ï¼š

ãƒ•ã‚¡ã‚¤ãƒ«åï¼š LogAnalyzer.java

```java
import java.io.*;
import java.util.*;
import java.util.regex.Pattern;
import java.util.regex.PatternSyntaxException;
import java.text.ParseException;
import java.text.SimpleDateFormat;

public class LogAnalyzer {
    private static final String DATE_PATTERN = "yyyy-MM-dd HH:mm:ss";
    private SimpleDateFormat dateFormat;
    private Map<String, Integer> logLevelCounts;
    
    public LogAnalyzer() {
        this.dateFormat = new SimpleDateFormat(DATE_PATTERN);
        this.logLevelCounts = new HashMap<>();
    }
    
    // åŒ…æ‹¬çš„ãªãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã¨è§£æãƒ¡ã‚½ãƒƒãƒ‰
    public void analyzeLogFile(String filename) {
        System.out.println("=== ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æã‚·ã‚¹ãƒ†ãƒ  ===");
        System.out.println("åˆ†æå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«: " + filename);
        
        FileReader fileReader = null;
        BufferedReader bufferedReader = null;
        
        try {
            // ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèªã¨èª­ã¿è¾¼ã¿ (FileNotFoundException ã®å¯èƒ½æ€§)
            File logFile = new File(filename);
            if (!logFile.exists()) {
                throw new FileNotFoundException("æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“: " + filename);
            }
            
            if (!logFile.canRead()) {
                throw new IOException("ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“: " + filename);
            }
            
            System.out.println("ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: " + logFile.length() + " bytes");
            
            fileReader = new FileReader(logFile);
            bufferedReader = new BufferedReader(fileReader);
            
            String line;
            int lineNumber = 0;
            int successfullyParsedLines = 0;
            int errorLines = 0;
            
            // ãƒ•ã‚¡ã‚¤ãƒ«ã®è¡Œã”ã¨å‡¦ç† (IOException ã®å¯èƒ½æ€§)
            while ((line = bufferedReader.readLine()) != null) {
                lineNumber++;
                
                try {
                    // ãƒ­ã‚°ã‚¨ãƒ³ãƒˆãƒªã®è§£æ (è¤‡æ•°ã®ä¾‹å¤–ã®å¯èƒ½æ€§)
                    LogEntry entry = parseLogLine(line, lineNumber);
                    
                    if (entry != null) {
                        processLogEntry(entry);
                        successfullyParsedLines++;
                    }
                    
                } catch (ParseException e) {
                    System.err.println("è¡Œ " + lineNumber + ": æ—¥ä»˜è§£æã‚¨ãƒ©ãƒ¼ - " + e.getMessage());
                    errorLines++;
                    
                } catch (IllegalArgumentException e) {
                    System.err.println("è¡Œ " + lineNumber + ": ä¸æ­£ãªãƒ­ã‚°å½¢å¼ - " + e.getMessage());
                    errorLines++;
                    
                } catch (PatternSyntaxException e) {
                    System.err.println("è¡Œ " + lineNumber + ": æ­£è¦è¡¨ç¾ã‚¨ãƒ©ãƒ¼ - " + e.getMessage());
                    errorLines++;
                }
            }
            
            // åˆ†æçµæœã®è¡¨ç¤º
            displayAnalysisResults(lineNumber, successfullyParsedLines, errorLines);
            
        } catch (FileNotFoundException e) {
            System.err.println("ãƒ•ã‚¡ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
            System.err.println("å¯¾å‡¦æ³•: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„");
            
        } catch (SecurityException e) {
            System.err.println("ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
            System.err.println("å¯¾å‡¦æ³•: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„");
            
        } catch (IOException e) {
            System.err.println("I/Oã‚¨ãƒ©ãƒ¼: " + e.getMessage());
            System.err.println("å¯¾å‡¦æ³•: ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„");
            
        } catch (OutOfMemoryError e) {
            System.err.println("ãƒ¡ãƒ¢ãƒªä¸è¶³ã‚¨ãƒ©ãƒ¼: ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤§ãã™ãã¾ã™");
            System.err.println("å¯¾å‡¦æ³•: JVMãƒ’ãƒ¼ãƒ—ã‚µã‚¤ã‚ºã‚’å¢—ã‚„ã™ã‹ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ†å‰²ã—ã¦ãã ã•ã„");
            
        } catch (Exception e) {
            // äºˆæœŸã—ãªã„ä¾‹å¤–ã®å‡¦ç†
            System.err.println("äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: " + e.getClass().getSimpleName());
            System.err.println("è©³ç´°: " + e.getMessage());
            e.printStackTrace();
            
        } finally {
            // ãƒªã‚½ãƒ¼ã‚¹ã®ç¢ºå®Ÿãªè§£æ”¾
            closeResources(bufferedReader, fileReader);
        }
    }
    
    // ãƒ­ã‚°è¡Œã®è§£æãƒ¡ã‚½ãƒƒãƒ‰ (è¤‡æ•°ã®ä¾‹å¤–ã‚’æŠ•ã’ã‚‹å¯èƒ½æ€§)
    private LogEntry parseLogLine(String line, int lineNumber) throws ParseException, IllegalArgumentException {
        if (line == null || line.trim().isEmpty()) {
            return null; // ç©ºè¡Œã¯ã‚¹ã‚­ãƒƒãƒ—
        }
        
        // ãƒ­ã‚°å½¢å¼: "2024-01-15 10:30:45 [INFO] ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"
        String[] parts = line.split(" ", 4);
        
        if (parts.length < 4) {
            throw new IllegalArgumentException("ä¸å®Œå…¨ãªãƒ­ã‚°å½¢å¼ï¼ˆå¿…è¦ãªè¦ç´ ãŒä¸è¶³ï¼‰: " + line);
        }
        
        // æ—¥ä»˜ã®è§£æ (ParseException ã®å¯èƒ½æ€§)
        Date timestamp;
        try {
            String dateTimeString = parts[0] + " " + parts[1];
            timestamp = dateFormat.parse(dateTimeString);
        } catch (ParseException e) {
            throw new ParseException("æ—¥ä»˜å½¢å¼ãŒä¸æ­£ã§ã™: " + parts[0] + " " + parts[1], e.getErrorOffset());
        }
        
        // ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã®è§£æ
        String logLevel = parts[2].replaceAll("[\\[\\]]", ""); // [ ] ã‚’é™¤å»
        if (!isValidLogLevel(logLevel)) {
            throw new IllegalArgumentException("ç„¡åŠ¹ãªãƒ­ã‚°ãƒ¬ãƒ™ãƒ«: " + logLevel);
        }
        
        String message = parts[3];
        
        return new LogEntry(timestamp, logLevel, message, lineNumber);
    }
    
    // ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯
    private boolean isValidLogLevel(String logLevel) {
        return Arrays.asList("DEBUG", "INFO", "WARN", "ERROR", "FATAL").contains(logLevel.toUpperCase());
    }
    
    // ãƒ­ã‚°ã‚¨ãƒ³ãƒˆãƒªã®å‡¦ç†
    private void processLogEntry(LogEntry entry) {
        String logLevel = entry.getLogLevel().toUpperCase();
        logLevelCounts.put(logLevel, logLevelCounts.getOrDefault(logLevel, 0) + 1);
        
        // é‡è¦åº¦ã®é«˜ã„ãƒ­ã‚°ã¯å³åº§ã«è¡¨ç¤º
        if ("ERROR".equals(logLevel) || "FATAL".equals(logLevel)) {
            System.out.println("é‡è¦: è¡Œ" + entry.getLineNumber() + " - " + entry.getMessage());
        }
    }
    
    // åˆ†æçµæœã®è¡¨ç¤º
    private void displayAnalysisResults(int totalLines, int successfulLines, int errorLines) {
        System.out.println("\n=== åˆ†æçµæœ ===");
        System.out.println("ç·è¡Œæ•°: " + totalLines);
        System.out.println("æ­£å¸¸ã«è§£æã•ã‚ŒãŸè¡Œæ•°: " + successfulLines);
        System.out.println("ã‚¨ãƒ©ãƒ¼è¡Œæ•°: " + errorLines);
        System.out.println("æˆåŠŸç‡: " + String.format("%.2f%%", (double) successfulLines / totalLines * 100));
        
        System.out.println("\n=== ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ¥çµ±è¨ˆ ===");
        for (Map.Entry<String, Integer> entry : logLevelCounts.entrySet()) {
            System.out.println(entry.getKey() + ": " + entry.getValue() + "ä»¶");
        }
    }
    
    // ãƒªã‚½ãƒ¼ã‚¹ã®ç¢ºå®Ÿãªè§£æ”¾
    private void closeResources(BufferedReader bufferedReader, FileReader fileReader) {
        try {
            if (bufferedReader != null) {
                bufferedReader.close();
                System.out.println("BufferedReader ã‚’é–‰ã˜ã¾ã—ãŸ");
            }
        } catch (IOException e) {
            System.err.println("BufferedReader ã®é–‰é–ã§ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
        }
        
        try {
            if (fileReader != null) {
                fileReader.close();
                System.out.println("FileReader ã‚’é–‰ã˜ã¾ã—ãŸ");
            }
        } catch (IOException e) {
            System.err.println("FileReader ã®é–‰é–ã§ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
        }
    }
    
    // ãƒ­ã‚°ã‚¨ãƒ³ãƒˆãƒªã‚’è¡¨ç¾ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹
    private static class LogEntry {
        private Date timestamp;
        private String logLevel;
        private String message;
        private int lineNumber;
        
        public LogEntry(Date timestamp, String logLevel, String message, int lineNumber) {
            this.timestamp = timestamp;
            this.logLevel = logLevel;
            this.message = message;
            this.lineNumber = lineNumber;
        }
        
        public Date getTimestamp() { return timestamp; }
        public String getLogLevel() { return logLevel; }
        public String getMessage() { return message; }
        public int getLineNumber() { return lineNumber; }
    }
    
    public static void main(String[] args) {
        LogAnalyzer analyzer = new LogAnalyzer();
        
        // ãƒ†ã‚¹ãƒˆç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«å
        String[] testFiles = {
            "application.log",
            "error.log", 
            "non_existent.log"
        };
        
        for (String filename : testFiles) {
            try {
                analyzer.analyzeLogFile(filename);
                System.out.println("\n" + "=".repeat(50) + "\n");
            } catch (Exception e) {
                System.err.println("ãƒ•ã‚¡ã‚¤ãƒ« " + filename + " ã®å‡¦ç†ä¸­ã«è‡´å‘½çš„ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
            }
        }
    }
}
```

**ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰å­¦ã¶é‡è¦ãªè¤‡æ•°ä¾‹å¤–å‡¦ç†ã®æ¦‚å¿µï¼š**

1. **ä¾‹å¤–ã®éšå±¤çš„å‡¦ç†**ï¼šå…·ä½“çš„ãªä¾‹å¤–ï¼ˆFileNotFoundExceptionï¼‰ã‹ã‚‰æ±ç”¨çš„ãªä¾‹å¤–ï¼ˆExceptionï¼‰ã¾ã§ã€é©åˆ‡ãªé †åºã§ä¾‹å¤–ã‚’ã‚­ãƒ£ãƒƒãƒã—ã¦ã„ã¾ã™ã€‚

2. **ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ã®é‡è¦æ€§**ï¼šfinallyç¯€ã§ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚½ãƒ¼ã‚¹ã‚’ç¢ºå®Ÿã«è§£æ”¾ã—ã€ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã‚’é˜²ã„ã§ã„ã¾ã™ã€‚

3. **ã‚¨ãƒ©ãƒ¼æƒ…å ±ã®è©³ç´°åŒ–**ï¼šå„ä¾‹å¤–ã«å¯¾ã—ã¦é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨å¯¾å‡¦æ³•ã‚’æä¾›ã—ã€å•é¡Œè§£æ±ºã‚’æ”¯æ´ã—ã¦ã„ã¾ã™ã€‚

4. **éƒ¨åˆ†çš„ãªéšœå®³ã¸ã®å¯¾å¿œ**ï¼šä¸€éƒ¨ã®è¡Œã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã‚‚å‡¦ç†ã‚’ç¶™ç¶šã—ã€å¯èƒ½ãªé™ã‚Šå¤šãã®ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã—ã¾ã™ã€‚

5. **ãƒ­ã‚°ã®é‡è¦åº¦ã«ã‚ˆã‚‹å‡¦ç†åˆ†å²**ï¼šã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ™ãƒ«ã®ãƒ­ã‚°ã¯å³åº§ã«è¡¨ç¤ºã™ã‚‹ãªã©ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã«å¿œã˜ãŸä¾‹å¤–å‡¦ç†ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

**å®Ÿç”¨çš„ãªå¿œç”¨å ´é¢ï¼š**

- **ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ **ï¼šCSVãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€æ‹¬å‡¦ç†
- **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿**ï¼šã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®šã®å‹•çš„èª­ã¿è¾¼ã¿
- **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚·ã‚¹ãƒ†ãƒ **ï¼šãƒ•ã‚¡ã‚¤ãƒ«ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ã¨å¾©æ—§å‡¦ç†
- **ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ **ï¼šã‚·ã‚¹ãƒ†ãƒ ã®å¥å…¨æ€§ã‚’ç¤ºã™ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®åé›†ã¨åˆ†æ

## 6.2 ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–ã®å®Ÿè·µä¾‹ï¼šéŠ€è¡Œå£åº§ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å›ºæœ‰ã®ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚„ã‚¨ãƒ©ãƒ¼çŠ¶æ³ã‚’è¡¨ç¾ã™ã‚‹ãŸã‚ã®å¼·åŠ›ãªä»•çµ„ã¿ã§ã™ã€‚ä»¥ä¸‹ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã€éŠ€è¡Œå£åº§ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã¨ã„ã†å®Ÿç”¨çš„ãªä¾‹ã‚’é€šã˜ã¦ã€æ„å‘³ã®ã‚ã‚‹ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–ã®è¨­è¨ˆã¨æ´»ç”¨æ–¹æ³•ã‚’å­¦ç¿’ã™ã‚‹ãŸã‚ã®ææ–™ã§ã™ï¼š

ãƒ•ã‚¡ã‚¤ãƒ«åï¼š BankingSystem.java

```java
import java.util.*;

// ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–1: æ®‹é«˜ä¸è¶³ä¾‹å¤–
class InsufficientFundsException extends Exception {
    private double requestedAmount;
    private double availableBalance;
    
    public InsufficientFundsException(double requestedAmount, double availableBalance) {
        super(String.format("æ®‹é«˜ä¸è¶³: è¦æ±‚é¡ %.2få††ã«å¯¾ã—ã¦åˆ©ç”¨å¯èƒ½æ®‹é«˜ã¯ %.2få††ã§ã™", 
                          requestedAmount, availableBalance));
        this.requestedAmount = requestedAmount;
        this.availableBalance = availableBalance;
    }
    
    public double getRequestedAmount() { return requestedAmount; }
    public double getAvailableBalance() { return availableBalance; }
    public double getShortfall() { return requestedAmount - availableBalance; }
}

// ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–2: ç„¡åŠ¹ãªå£åº§æ“ä½œä¾‹å¤–
class InvalidAccountOperationException extends Exception {
    private String accountNumber;
    private String operationType;
    private String reason;
    
    public InvalidAccountOperationException(String accountNumber, String operationType, String reason) {
        super(String.format("å£åº§ %s ã§ã® %s æ“ä½œãŒç„¡åŠ¹ã§ã™: %s", accountNumber, operationType, reason));
        this.accountNumber = accountNumber;
        this.operationType = operationType;
        this.reason = reason;
    }
    
    public String getAccountNumber() { return accountNumber; }
    public String getOperationType() { return operationType; }
    public String getReason() { return reason; }
}

// ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–3: å£åº§ãŒè¦‹ã¤ã‹ã‚‰ãªã„ä¾‹å¤–
class AccountNotFoundException extends Exception {
    private String accountNumber;
    
    public AccountNotFoundException(String accountNumber) {
        super("å£åº§ç•ªå· " + accountNumber + " ã¯å­˜åœ¨ã—ã¾ã›ã‚“");
        this.accountNumber = accountNumber;
    }
    
    public String getAccountNumber() { return accountNumber; }
}

// ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–4: æ—¥æ¬¡é™åº¦é¡è¶…éä¾‹å¤–
class DailyLimitExceededException extends Exception {
    private double attemptedAmount;
    private double dailyLimit;
    private double alreadyUsed;
    
    public DailyLimitExceededException(double attemptedAmount, double dailyLimit, double alreadyUsed) {
        super(String.format("æ—¥æ¬¡é™åº¦é¡è¶…é: è©¦è¡Œé¡ %.2få††, é™åº¦é¡ %.2få††, æœ¬æ—¥åˆ©ç”¨æ¸ˆã¿ %.2få††", 
                          attemptedAmount, dailyLimit, alreadyUsed));
        this.attemptedAmount = attemptedAmount;
        this.dailyLimit = dailyLimit;
        this.alreadyUsed = alreadyUsed;
    }
    
    public double getAttemptedAmount() { return attemptedAmount; }
    public double getDailyLimit() { return dailyLimit; }
    public double getAlreadyUsed() { return alreadyUsed; }
    public double getRemainingLimit() { return dailyLimit - alreadyUsed; }
}

// éŠ€è¡Œå£åº§ã‚¯ãƒ©ã‚¹
class BankAccount {
    private String accountNumber;
    private String accountHolder;
    private double balance;
    private boolean isActive;
    private double dailyWithdrawalLimit;
    private double todayWithdrawn;
    private Date lastTransactionDate;
    
    public BankAccount(String accountNumber, String accountHolder, double initialBalance) {
        this.accountNumber = accountNumber;
        this.accountHolder = accountHolder;
        this.balance = initialBalance;
        this.isActive = true;
        this.dailyWithdrawalLimit = 100000; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ—¥æ¬¡é™åº¦é¡: 10ä¸‡å††
        this.todayWithdrawn = 0;
        this.lastTransactionDate = new Date();
    }
    
    // é é‡‘æ“ä½œ
    public void deposit(double amount) throws InvalidAccountOperationException {
        validateAccount();
        
        if (amount <= 0) {
            throw new InvalidAccountOperationException(accountNumber, "é é‡‘", "é‡‘é¡ã¯æ­£ã®å€¤ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™");
        }
        
        if (amount > 1000000) { // 100ä¸‡å††ã‚’è¶…ãˆã‚‹é é‡‘ã¯åˆ¶é™
            throw new InvalidAccountOperationException(accountNumber, "é é‡‘", "ä¸€åº¦ã«é é‡‘ã§ãã‚‹ä¸Šé™ã¯100ä¸‡å††ã§ã™");
        }
        
        balance += amount;
        lastTransactionDate = new Date();
        System.out.printf("é é‡‘å®Œäº†: %.2få††ãŒå£åº§ %s ã«é é‡‘ã•ã‚Œã¾ã—ãŸã€‚æ–°æ®‹é«˜: %.2få††\n", 
                         amount, accountNumber, balance);
    }
    
    // å‡ºé‡‘æ“ä½œ
    public void withdraw(double amount) throws InsufficientFundsException, 
                                             InvalidAccountOperationException, 
                                             DailyLimitExceededException {
        validateAccount();
        validateWithdrawalAmount(amount);
        checkDailyLimit(amount);
        checkSufficientFunds(amount);
        
        balance -= amount;
        todayWithdrawn += amount;
        lastTransactionDate = new Date();
        
        System.out.printf("å‡ºé‡‘å®Œäº†: %.2få††ãŒå£åº§ %s ã‹ã‚‰å‡ºé‡‘ã•ã‚Œã¾ã—ãŸã€‚æ–°æ®‹é«˜: %.2få††\n", 
                         amount, accountNumber, balance);
    }
    
    // å£åº§ã®å¦¥å½“æ€§ç¢ºèª
    private void validateAccount() throws InvalidAccountOperationException {
        if (!isActive) {
            throw new InvalidAccountOperationException(accountNumber, "å–å¼•", "å£åº§ãŒç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã¾ã™");
        }
    }
    
    // å‡ºé‡‘é¡ã®å¦¥å½“æ€§ç¢ºèª
    private void validateWithdrawalAmount(double amount) throws InvalidAccountOperationException {
        if (amount <= 0) {
            throw new InvalidAccountOperationException(accountNumber, "å‡ºé‡‘", "å‡ºé‡‘é¡ã¯æ­£ã®å€¤ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™");
        }
        
        if (amount > 500000) { // 50ä¸‡å††ã‚’è¶…ãˆã‚‹å‡ºé‡‘ã¯åˆ¶é™
            throw new InvalidAccountOperationException(accountNumber, "å‡ºé‡‘", "ä¸€åº¦ã«å‡ºé‡‘ã§ãã‚‹ä¸Šé™ã¯50ä¸‡å††ã§ã™");
        }
    }
    
    // æ—¥æ¬¡é™åº¦é¡ãƒã‚§ãƒƒã‚¯
    private void checkDailyLimit(double amount) throws DailyLimitExceededException {
        if (todayWithdrawn + amount > dailyWithdrawalLimit) {
            throw new DailyLimitExceededException(amount, dailyWithdrawalLimit, todayWithdrawn);
        }
    }
    
    // æ®‹é«˜ç¢ºèª
    private void checkSufficientFunds(double amount) throws InsufficientFundsException {
        if (amount > balance) {
            throw new InsufficientFundsException(amount, balance);
        }
    }
    
    // å£åº§æƒ…å ±ã®è¡¨ç¤º
    public void displayAccountInfo() {
        System.out.println("=== å£åº§æƒ…å ± ===");
        System.out.println("å£åº§ç•ªå·: " + accountNumber);
        System.out.println("å£åº§åç¾©: " + accountHolder);
        System.out.printf("æ®‹é«˜: %.2få††\n", balance);
        System.out.println("å£åº§çŠ¶æ…‹: " + (isActive ? "æœ‰åŠ¹" : "ç„¡åŠ¹"));
        System.out.printf("æ—¥æ¬¡å‡ºé‡‘é™åº¦é¡: %.2få††\n", dailyWithdrawalLimit);
        System.out.printf("æœ¬æ—¥å‡ºé‡‘æ¸ˆã¿: %.2få††\n", todayWithdrawn);
        System.out.printf("æœ¬æ—¥ã®æ®‹ã‚Šé™åº¦é¡: %.2få††\n", dailyWithdrawalLimit - todayWithdrawn);
    }
    
    // ã‚¢ã‚¯ã‚»ã‚µãƒ¡ã‚½ãƒƒãƒ‰
    public String getAccountNumber() { return accountNumber; }
    public double getBalance() { return balance; }
    public boolean isActive() { return isActive; }
    public void setActive(boolean active) { this.isActive = active; }
}

// éŠ€è¡Œã‚·ã‚¹ãƒ†ãƒ ç®¡ç†ã‚¯ãƒ©ã‚¹
class BankingSystem {
    private Map<String, BankAccount> accounts;
    
    public BankingSystem() {
        this.accounts = new HashMap<>();
    }
    
    public void addAccount(BankAccount account) {
        accounts.put(account.getAccountNumber(), account);
        System.out.println("å£åº§ " + account.getAccountNumber() + " ãŒã‚·ã‚¹ãƒ†ãƒ ã«è¿½åŠ ã•ã‚Œã¾ã—ãŸ");
    }
    
    public BankAccount getAccount(String accountNumber) throws AccountNotFoundException {
        BankAccount account = accounts.get(accountNumber);
        if (account == null) {
            throw new AccountNotFoundException(accountNumber);
        }
        return account;
    }
    
    // æŒ¯è¾¼æ“ä½œï¼ˆè¤‡æ•°ã®ä¾‹å¤–ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ï¼‰
    public void transfer(String fromAccount, String toAccount, double amount) 
            throws AccountNotFoundException, InsufficientFundsException, 
                   InvalidAccountOperationException, DailyLimitExceededException {
        
        System.out.println("\n=== æŒ¯è¾¼å‡¦ç†é–‹å§‹ ===");
        System.out.printf("é€é‡‘å…ƒ: %s â†’ é€é‡‘å…ˆ: %s, é‡‘é¡: %.2få††\n", fromAccount, toAccount, amount);
        
        BankAccount from = getAccount(fromAccount);
        BankAccount to = getAccount(toAccount);
        
        // é€é‡‘å…ƒã‹ã‚‰å‡ºé‡‘
        from.withdraw(amount);
        
        try {
            // é€é‡‘å…ˆã«é é‡‘
            to.deposit(amount);
            System.out.println("æŒ¯è¾¼ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸ");
            
        } catch (InvalidAccountOperationException e) {
            // é€é‡‘å…ˆã¸ã®é é‡‘ã«å¤±æ•—ã—ãŸå ´åˆã€é€é‡‘å…ƒã«è¿”é‡‘
            try {
                from.deposit(amount);
                System.out.println("é€é‡‘å…ˆé é‡‘å¤±æ•—ã®ãŸã‚ã€é€é‡‘å…ƒã«è¿”é‡‘ã—ã¾ã—ãŸ");
            } catch (InvalidAccountOperationException returnError) {
                System.err.println("é‡å¤§ã‚¨ãƒ©ãƒ¼: è¿”é‡‘å‡¦ç†ã‚‚å¤±æ•—ã—ã¾ã—ãŸ - " + returnError.getMessage());
            }
            throw e; // å…ƒã®ä¾‹å¤–ã‚’å†ã‚¹ãƒ­ãƒ¼
        }
    }
}

public class BankingSystemDemo {
    public static void main(String[] args) {
        BankingSystem bank = new BankingSystem();
        
        // ãƒ†ã‚¹ãƒˆç”¨å£åº§ã®ä½œæˆ
        BankAccount account1 = new BankAccount("001-12345", "ç”°ä¸­å¤ªéƒ", 500000);
        BankAccount account2 = new BankAccount("001-67890", "ä½è—¤èŠ±å­", 300000);
        
        bank.addAccount(account1);
        bank.addAccount(account2);
        
        System.out.println("\n=== éŠ€è¡Œå–å¼•ã‚·ã‚¹ãƒ†ãƒ  ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ===");
        
        // æ­£å¸¸ãªå–å¼•ã®ãƒ†ã‚¹ãƒˆ
        try {
            account1.displayAccountInfo();
            account1.deposit(50000);
            account1.withdraw(30000);
            System.out.println("å–å¼•å¾Œã®æƒ…å ±:");
            account1.displayAccountInfo();
            
        } catch (InsufficientFundsException e) {
            System.err.println("æ®‹é«˜ä¸è¶³ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
            System.err.printf("ä¸è¶³é¡: %.2få††\n", e.getShortfall());
            
        } catch (InvalidAccountOperationException e) {
            System.err.println("ç„¡åŠ¹æ“ä½œã‚¨ãƒ©ãƒ¼: " + e.getMessage());
            System.err.println("æ“ä½œã‚¿ã‚¤ãƒ—: " + e.getOperationType());
            
        } catch (DailyLimitExceededException e) {
            System.err.println("æ—¥æ¬¡é™åº¦é¡ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
            System.err.printf("æœ¬æ—¥ã®æ®‹ã‚Šé™åº¦é¡: %.2få††\n", e.getRemainingLimit());
        }
        
        // ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ
        System.out.println("\n=== ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ ===");
        
        try {
            // æ®‹é«˜ä¸è¶³ãƒ†ã‚¹ãƒˆ
            account2.withdraw(400000);
            
        } catch (Exception e) {
            System.err.println("äºˆæœŸã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼: " + e.getMessage());
        }
        
        try {
            // å­˜åœ¨ã—ãªã„å£åº§ã¸ã®æŒ¯è¾¼ãƒ†ã‚¹ãƒˆ
            bank.transfer("001-12345", "999-99999", 10000);
            
        } catch (AccountNotFoundException e) {
            System.err.println("å£åº§ä¸å­˜åœ¨ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
            System.err.println("æ¢ç´¢å¯¾è±¡å£åº§: " + e.getAccountNumber());
            
        } catch (Exception e) {
            System.err.println("ãã®ä»–ã®ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
        }
        
        try {
            // ç„¡åŠ¹ãªé‡‘é¡ã§ã®å–å¼•ãƒ†ã‚¹ãƒˆ
            account1.withdraw(-5000);
            
        } catch (Exception e) {
            System.err.println("ç„¡åŠ¹é‡‘é¡ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
        }
    }
}
```

**ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰å­¦ã¶é‡è¦ãªã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–ã®æ¦‚å¿µï¼š**

1. **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®è¡¨ç¾**ï¼šå„ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–ãŒãã‚Œãã‚Œç‰¹å®šã®ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«é•åï¼ˆæ®‹é«˜ä¸è¶³ã€æ—¥æ¬¡é™åº¦é¡è¶…éç­‰ï¼‰ã‚’è¡¨ç¾ã—ã¦ã„ã¾ã™ã€‚

2. **è©³ç´°æƒ…å ±ã®ä¿æŒ**ï¼šä¾‹å¤–ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã«é–¢é€£ã™ã‚‹ãƒ“ã‚¸ãƒã‚¹ãƒ‡ãƒ¼ã‚¿ï¼ˆè¦æ±‚é¡ã€åˆ©ç”¨å¯èƒ½æ®‹é«˜ç­‰ï¼‰ã‚’ä¿æŒã—ã€é©åˆ‡ãªå¯¾å‡¦æ³•ã®æç¤ºã‚’å¯èƒ½ã«ã—ã¦ã„ã¾ã™ã€‚

3. **ä¾‹å¤–ã®éšå±¤åŒ–**ï¼šã™ã¹ã¦ã®ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–ãŒExceptionã‚’ç¶™æ‰¿ã—ã€çµ±ä¸€çš„ãªä¾‹å¤–å‡¦ç†ã‚’å¯èƒ½ã«ã—ã¦ã„ã¾ã™ã€‚

4. **ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†**ï¼šæŒ¯è¾¼å‡¦ç†ã§ã®éƒ¨åˆ†çš„å¤±æ•—æ™‚ã«ã€ã™ã§ã«å®Ÿè¡Œã•ã‚ŒãŸå‡¦ç†ã‚’å–ã‚Šæ¶ˆã™ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

5. **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ã®å‘ä¸Š**ï¼šæŠ€è¡“çš„ãªè©³ç´°ã§ã¯ãªãã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç†è§£ã—ã‚„ã™ã„ãƒ“ã‚¸ãƒã‚¹çš„ãªè¦³ç‚¹ã§ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

**å®Ÿç”¨çš„ãªå¿œç”¨å ´é¢ï¼š**

- **Eã‚³ãƒãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ **ï¼šåœ¨åº«ä¸è¶³ã€æ”¯æ‰•ã„å¤±æ•—ã€é…é€ã‚¨ãƒ©ãƒ¼ç­‰ã®æ¥­å‹™ä¾‹å¤–
- **äºˆç´„ã‚·ã‚¹ãƒ†ãƒ **ï¼šé‡è¤‡äºˆç´„ã€ã‚­ãƒ£ãƒ³ã‚»ãƒ«æœŸé™è¶…éã€å®šå“¡ã‚ªãƒ¼ãƒãƒ¼ç­‰ã®ä¾‹å¤–
- **èªè¨¼ã‚·ã‚¹ãƒ†ãƒ **ï¼šç„¡åŠ¹ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯ã€æ¨©é™ä¸è¶³ç­‰ã®ä¾‹å¤–
- **åœ¨åº«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ **ï¼šç™ºæ³¨æ•°é‡ã‚¨ãƒ©ãƒ¼ã€æœŸé™åˆ‡ã‚Œå•†å“ã€å€‰åº«å®¹é‡è¶…éç­‰ã®ä¾‹å¤–

## 6.3 try-with-resourcesã®å®Ÿè·µä¾‹ï¼šè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

try-with-resourcesæ–‡ã¯ã€ãƒªã‚½ãƒ¼ã‚¹ã®ç¢ºå®Ÿãªè§£æ”¾ã‚’è‡ªå‹•åŒ–ã™ã‚‹é‡è¦ãªä»•çµ„ã¿ã§ã™ã€‚ä»¥ä¸‹ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã¨ã„ã†å®Ÿç”¨çš„ãªä¾‹ã‚’é€šã˜ã¦ã€å®‰å…¨ã§åŠ¹ç‡çš„ãªãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ã®æ–¹æ³•ã‚’å­¦ç¿’ã™ã‚‹ãŸã‚ã®ææ–™ã§ã™ï¼š

ãƒ•ã‚¡ã‚¤ãƒ«åï¼š ConfigurationManager.java

```java
import java.io.*;
import java.util.*;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantReadWriteLock;
import java.nio.file.*;
import java.nio.charset.StandardCharsets;

public class ConfigurationManager {
    private static final String CONFIG_DIR = "./config/";
    private Map<String, String> configCache;
    private ReentrantReadWriteLock lock;
    
    public ConfigurationManager() {
        this.configCache = new HashMap<>();
        this.lock = new ReentrantReadWriteLock();
    }
    
    // try-with-resources ã‚’ä½¿ç”¨ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
    public Properties loadConfiguration(String configFileName) throws IOException {
        Properties props = new Properties();
        String fullPath = CONFIG_DIR + configFileName;
        
        System.out.println("è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ä¸­: " + fullPath);
        
        // try-with-resources: è¤‡æ•°ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’åŒæ™‚ã«ç®¡ç†
        try (InputStream fileInput = Files.newInputStream(Paths.get(fullPath));
             BufferedInputStream bufferedInput = new BufferedInputStream(fileInput);
             InputStreamReader reader = new InputStreamReader(bufferedInput, StandardCharsets.UTF_8)) {
            
            props.load(reader);
            
            System.out.println("è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿å®Œäº†: " + props.size() + " é …ç›®");
            
            // èª­ã¿è¾¼ã‚“ã è¨­å®šã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜
            cacheConfiguration(configFileName, props);
            
        } catch (NoSuchFileException e) {
            System.err.println("è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: " + fullPath);
            throw new IOException("è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: " + configFileName, e);
            
        } catch (AccessDeniedException e) {
            System.err.println("è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“: " + fullPath);
            throw new IOException("ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚¨ãƒ©ãƒ¼: " + configFileName, e);
        }
        // try-with-resources ã«ã‚ˆã‚Šã€å…¨ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ãŒè‡ªå‹•çš„ã«é–‰ã˜ã‚‰ã‚Œã‚‹
        
        return props;
    }
    
    // try-with-resources ã‚’ä½¿ç”¨ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«æ›¸ãè¾¼ã¿
    public void saveConfiguration(String configFileName, Properties props) throws IOException {
        String fullPath = CONFIG_DIR + configFileName;
        String backupPath = fullPath + ".backup";
        
        System.out.println("è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ä¸­: " + fullPath);
        
        // ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ
        createBackup(fullPath, backupPath);
        
        // try-with-resources: æ›¸ãè¾¼ã¿å°‚ç”¨ãƒªã‚½ãƒ¼ã‚¹ã®ç®¡ç†
        try (OutputStream fileOutput = Files.newOutputStream(Paths.get(fullPath), 
                                                             StandardOpenOption.CREATE, 
                                                             StandardOpenOption.TRUNCATE_EXISTING);
             BufferedOutputStream bufferedOutput = new BufferedOutputStream(fileOutput);
             OutputStreamWriter writer = new OutputStreamWriter(bufferedOutput, StandardCharsets.UTF_8)) {
            
            // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆä»˜ãï¼‰
            props.store(writer, "Configuration saved at " + new Date());
            
            System.out.println("è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜å®Œäº†: " + props.size() + " é …ç›®");
            
            // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ›´æ–°
            cacheConfiguration(configFileName, props);
            
        } catch (IOException e) {
            System.err.println("è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: " + e.getMessage());
            
            // ä¿å­˜ã«å¤±æ•—ã—ãŸå ´åˆã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒã‚’è©¦è¡Œ
            restoreFromBackup(backupPath, fullPath);
            throw e;
        }
    }
    
    // ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ
    private void createBackup(String originalPath, String backupPath) {
        try {
            Path original = Paths.get(originalPath);
            Path backup = Paths.get(backupPath);
            
            if (Files.exists(original)) {
                Files.copy(original, backup, StandardCopyOption.REPLACE_EXISTING);
                System.out.println("ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸ: " + backupPath);
            }
        } catch (IOException e) {
            System.err.println("ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆã«å¤±æ•—: " + e.getMessage());
        }
    }
    
    // ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ã®å¾©å…ƒ
    private void restoreFromBackup(String backupPath, String originalPath) {
        try (InputStream backup = Files.newInputStream(Paths.get(backupPath));
             OutputStream original = Files.newOutputStream(Paths.get(originalPath))) {
            
            backup.transferTo(original);
            System.out.println("ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¾©å…ƒã—ã¾ã—ãŸ");
            
        } catch (IOException e) {
            System.err.println("ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ã®å¾©å…ƒã«å¤±æ•—: " + e.getMessage());
        }
    }
    
    // ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•ãªã‚­ãƒ£ãƒƒã‚·ãƒ¥æ“ä½œ
    private void cacheConfiguration(String fileName, Properties props) {
        Lock writeLock = lock.writeLock();
        
        // try-with-resources ã®ä»£æ›¿ï¼šAutoCloseable ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®æ´»ç”¨
        try (AutoCloseableLock autoLock = new AutoCloseableLock(writeLock)) {
            
            for (String key : props.stringPropertyNames()) {
                String cacheKey = fileName + "." + key;
                configCache.put(cacheKey, props.getProperty(key));
            }
            
            System.out.println("è¨­å®šã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜ã—ã¾ã—ãŸï¼ˆ" + props.size() + " é …ç›®ï¼‰");
        }
    }
    
    // é«˜åº¦ãªãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†ï¼šãƒãƒƒãƒå‡¦ç†ã§ã®è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ
    public void processMultipleConfigFiles(List<String> configFiles) {
        List<String> successfulFiles = new ArrayList<>();
        List<String> failedFiles = new ArrayList<>();
        
        for (String configFile : configFiles) {
            
            // try-with-resources ã§ã®å€‹åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†
            try (FileInputStream fis = new FileInputStream(CONFIG_DIR + configFile);
                 Scanner scanner = new Scanner(fis, StandardCharsets.UTF_8)) {
                
                int lineCount = 0;
                Map<String, String> tempConfig = new HashMap<>();
                
                while (scanner.hasNextLine()) {
                    String line = scanner.nextLine().trim();
                    lineCount++;
                    
                    if (!line.isEmpty() && !line.startsWith("#")) {
                        String[] parts = line.split("=", 2);
                        if (parts.length == 2) {
                            tempConfig.put(parts[0].trim(), parts[1].trim());
                        }
                    }
                }
                
                System.out.printf("ãƒ•ã‚¡ã‚¤ãƒ« %s å‡¦ç†å®Œäº†: %dè¡Œ, %dè¨­å®šé …ç›®\n", 
                                configFile, lineCount, tempConfig.size());
                successfulFiles.add(configFile);
                
            } catch (FileNotFoundException e) {
                System.err.println("ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: " + configFile);
                failedFiles.add(configFile);
                
            } catch (IOException e) {
                System.err.println("ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†ã‚¨ãƒ©ãƒ¼ " + configFile + ": " + e.getMessage());
                failedFiles.add(configFile);
            }
            // scanner ã¨ fileInputStream ã¯è‡ªå‹•çš„ã«é–‰ã˜ã‚‰ã‚Œã‚‹
        }
        
        // å‡¦ç†çµæœã®ã‚µãƒãƒªãƒ¼è¡¨ç¤º
        displayProcessingSummary(successfulFiles, failedFiles);
    }
    
    // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒªã‚½ãƒ¼ã‚¹ã¨ã®çµ„ã¿åˆã‚ã›ä¾‹
    public void downloadAndSaveConfig(String url, String fileName) throws IOException {
        System.out.println("è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­: " + url);
        
        // æ³¨æ„: å®Ÿéš›ã®HTTPæ¥ç¶šã®ä»£ã‚ã‚Šã«ã€ãƒ¢ãƒƒã‚¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ç”¨
        try (MockHttpConnection connection = new MockHttpConnection(url);
             InputStream networkStream = connection.getInputStream();
             OutputStream fileStream = Files.newOutputStream(Paths.get(CONFIG_DIR + fileName));
             BufferedOutputStream bufferedOut = new BufferedOutputStream(fileStream)) {
            
            byte[] buffer = new byte[8192];
            int bytesRead;
            long totalBytes = 0;
            
            while ((bytesRead = networkStream.read(buffer)) != -1) {
                bufferedOut.write(buffer, 0, bytesRead);
                totalBytes += bytesRead;
            }
            
            System.out.printf("ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Œäº†: %s (%d bytes)\n", fileName, totalBytes);
            
        } catch (IOException e) {
            System.err.println("ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
            throw e;
        }
        // å…¨ã¦ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒªã‚½ãƒ¼ã‚¹ã¨ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚½ãƒ¼ã‚¹ãŒè‡ªå‹•çš„ã«é–‰ã˜ã‚‰ã‚Œã‚‹
    }
    
    private void displayProcessingSummary(List<String> successful, List<String> failed) {
        System.out.println("\n=== ãƒãƒƒãƒå‡¦ç†çµæœ ===");
        System.out.println("æˆåŠŸ: " + successful.size() + " ãƒ•ã‚¡ã‚¤ãƒ«");
        System.out.println("å¤±æ•—: " + failed.size() + " ãƒ•ã‚¡ã‚¤ãƒ«");
        
        if (!failed.isEmpty()) {
            System.out.println("å¤±æ•—ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«: " + String.join(", ", failed));
        }
    }
    
    // AutoCloseable ã‚’å®Ÿè£…ã—ãŸãƒ­ãƒƒã‚¯ã‚¯ãƒ©ã‚¹ï¼ˆtry-with-resources ã§ã®ä½¿ç”¨ä¾‹ï¼‰
    private static class AutoCloseableLock implements AutoCloseable {
        private final Lock lock;
        
        public AutoCloseableLock(Lock lock) {
            this.lock = lock;
            this.lock.lock();
        }
        
        @Override
        public void close() {
            lock.unlock();
        }
    }
    
    // ãƒ¢ãƒƒã‚¯HTTPæ¥ç¶šã‚¯ãƒ©ã‚¹ï¼ˆå®Ÿéš›ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å‡¦ç†ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ï¼‰
    private static class MockHttpConnection implements AutoCloseable {
        private String url;
        private boolean closed = false;
        
        public MockHttpConnection(String url) throws IOException {
            this.url = url;
            System.out.println("HTTPæ¥ç¶šã‚’é–‹å§‹: " + url);
            
            // æ¥ç¶šã‚¨ãƒ©ãƒ¼ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            if (url.contains("invalid")) {
                throw new IOException("ç„¡åŠ¹ãªURL: " + url);
            }
        }
        
        public InputStream getInputStream() {
            // ã‚µãƒ³ãƒ—ãƒ«è¨­å®šãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™ãƒ¢ãƒƒã‚¯ã‚¹ãƒˆãƒªãƒ¼ãƒ 
            String sampleConfig = "# Sample Configuration\n" +
                                  "app.name=Sample Application\n" +
                                  "app.version=1.0.0\n" +
                                  "app.debug=true\n";
            return new ByteArrayInputStream(sampleConfig.getBytes(StandardCharsets.UTF_8));
        }
        
        @Override
        public void close() throws IOException {
            if (!closed) {
                System.out.println("HTTPæ¥ç¶šã‚’é–‰ã˜ã¾ã—ãŸ: " + url);
                closed = true;
            }
        }
    }
    
    public static void main(String[] args) {
        ConfigurationManager manager = new ConfigurationManager();
        
        // ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ
        try {
            Files.createDirectories(Paths.get(CONFIG_DIR));
        } catch (IOException e) {
            System.err.println("è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆã«å¤±æ•—: " + e.getMessage());
            return;
        }
        
        System.out.println("=== è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ===");
        
        // ã‚µãƒ³ãƒ—ãƒ«è¨­å®šã®ä½œæˆã¨ä¿å­˜
        Properties sampleConfig = new Properties();
        sampleConfig.setProperty("database.url", "jdbc:mysql://localhost:3306/app");
        sampleConfig.setProperty("database.username", "appuser");
        sampleConfig.setProperty("server.port", "8080");
        sampleConfig.setProperty("logging.level", "INFO");
        
        try {
            // è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜
            manager.saveConfiguration("application.properties", sampleConfig);
            
            // è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿
            Properties loadedConfig = manager.loadConfiguration("application.properties");
            
            System.out.println("\nèª­ã¿è¾¼ã¾ã‚ŒãŸè¨­å®š:");
            for (String key : loadedConfig.stringPropertyNames()) {
                System.out.println("  " + key + " = " + loadedConfig.getProperty(key));
            }
            
            // è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒƒãƒå‡¦ç†
            List<String> configFiles = Arrays.asList(
                "application.properties",
                "database.properties",  // å­˜åœ¨ã—ãªã„ãƒ•ã‚¡ã‚¤ãƒ«
                "logging.properties"    // å­˜åœ¨ã—ãªã„ãƒ•ã‚¡ã‚¤ãƒ«
            );
            
            manager.processMultipleConfigFiles(configFiles);
            
            // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã®ãƒ‡ãƒ¢
            manager.downloadAndSaveConfig("http://example.com/config", "downloaded.properties");
            
        } catch (IOException e) {
            System.err.println("è¨­å®šç®¡ç†ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
            e.printStackTrace();
        }
    }
}
```

**ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰å­¦ã¶é‡è¦ãªtry-with-resources ã®æ¦‚å¿µï¼š**

1. **è‡ªå‹•ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†**ï¼štry-with-resourcesæ–‡ã«ã‚ˆã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒªãƒ¼ãƒ ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã€ãƒ­ãƒƒã‚¯ãªã©ã®ãƒªã‚½ãƒ¼ã‚¹ãŒç¢ºå®Ÿã«è§£æ”¾ã•ã‚Œã¾ã™ã€‚

2. **è¤‡æ•°ãƒªã‚½ãƒ¼ã‚¹ã®åŒæ™‚ç®¡ç†**ï¼š1ã¤ã®tryæ–‡ã§è¤‡æ•°ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’åŒæ™‚ã«ç®¡ç†ã—ã€é€†é †ã§è‡ªå‹•çš„ã«é–‰ã˜ã‚‰ã‚Œã¾ã™ã€‚

3. **ä¾‹å¤–å®‰å…¨æ€§**ï¼šãƒªã‚½ãƒ¼ã‚¹ã®ã‚¯ãƒ­ãƒ¼ã‚ºå‡¦ç†ä¸­ã«ä¾‹å¤–ãŒç™ºç”Ÿã—ã¦ã‚‚ã€ã™ã¹ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ãŒé©åˆ‡ã«è§£æ”¾ã•ã‚Œã¾ã™ã€‚

4. **AutoCloseableã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹**ï¼šã‚«ã‚¹ã‚¿ãƒ ã‚¯ãƒ©ã‚¹ã§AutoCloseableã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€try-with-resourcesã®æ©æµã‚’å—ã‘ã‚‰ã‚Œã¾ã™ã€‚

5. **å¯èª­æ€§ã®å‘ä¸Š**ï¼šfinallyç¯€ã§ã®æ˜ç¤ºçš„ãªã‚¯ãƒ­ãƒ¼ã‚ºå‡¦ç†ãŒä¸è¦ã«ãªã‚Šã€ã‚³ãƒ¼ãƒ‰ãŒã‚ˆã‚Šç°¡æ½”ã§ç†è§£ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚

**å¾“æ¥ã®finallyç¯€ã¨ã®æ¯”è¼ƒï¼š**

```java
// å¾“æ¥ã®æ–¹æ³•ï¼ˆéæ¨å¥¨ï¼‰
FileInputStream fis = null;
try {
    fis = new FileInputStream("file.txt");
    // ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†
} catch (IOException e) {
    // ã‚¨ãƒ©ãƒ¼å‡¦ç†
} finally {
    if (fis != null) {
        try {
            fis.close();
        } catch (IOException e) {
            // ã‚¯ãƒ­ãƒ¼ã‚ºã‚¨ãƒ©ãƒ¼ã®å‡¦ç†
        }
    }
}

// try-with-resourcesï¼ˆæ¨å¥¨ï¼‰
try (FileInputStream fis = new FileInputStream("file.txt")) {
    // ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†
} catch (IOException e) {
    // ã‚¨ãƒ©ãƒ¼å‡¦ç†
}
```

**å®Ÿç”¨çš„ãªå¿œç”¨å ´é¢ï¼š**

- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š**ï¼šConnectionã€PreparedStatementã€ResultSetã®ç®¡ç†
- **ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†**ï¼šå¤§é‡ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€æ‹¬å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ 
- **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡**ï¼šHTTPæ¥ç¶šã€ã‚½ã‚±ãƒƒãƒˆé€šä¿¡ã®å®‰å…¨ãªç®¡ç†
- **ä¸¦è¡Œå‡¦ç†**ï¼šãƒ­ãƒƒã‚¯ã‚„ã‚»ãƒãƒ•ã‚©ã®ç¢ºå®Ÿãªè§£æ”¾

## ã¾ã¨ã‚

é©åˆ‡ãªä¾‹å¤–å‡¦ç†ã«ã‚ˆã‚Šã€å …ç‰¢ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã§ãã¾ã™ã€‚æœ¬ç« ã§å­¦ç¿’ã—ãŸå†…å®¹ï¼š

1. **åŸºæœ¬çš„ãªä¾‹å¤–å‡¦ç†**ï¼štry-catch-finallyæ–‡ã«ã‚ˆã‚‹å®‰å…¨ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
2. **è¤‡æ•°ä¾‹å¤–ã®å‡¦ç†**ï¼šä¾‹å¤–ã®éšå±¤ã¨é©åˆ‡ãªé †åºã§ã®å‡¦ç†
3. **ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–**ï¼šãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã«ç‰¹åŒ–ã—ãŸæ„å‘³ã®ã‚ã‚‹ä¾‹å¤–è¨­è¨ˆ
4. **try-with-resources**ï¼šãƒªã‚½ãƒ¼ã‚¹ã®è‡ªå‹•ç®¡ç†ã«ã‚ˆã‚‹å®‰å…¨ãªãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°

ã“ã‚Œã‚‰ã®æŠ€è¡“ã‚’é©åˆ‡ã«çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ã‚¨ãƒ©ãƒ¼ã«å¼·ãã€ä¿å®ˆæ€§ã®é«˜ã„Javaã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã§ãã¾ã™ã€‚ä¾‹å¤–å‡¦ç†ã¯å˜ãªã‚‹ã€Œã‚¨ãƒ©ãƒ¼å¯¾å¿œã€ã§ã¯ãªãã€ã‚·ã‚¹ãƒ†ãƒ ã®ä¿¡é ¼æ€§ã¨å“è³ªã‚’æ ¹æœ¬çš„ã«å‘ä¸Šã•ã›ã‚‹é‡è¦ãªè¨­è¨ˆæ‰‹æ³•ã§ã™ã€‚