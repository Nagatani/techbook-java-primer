# 第9章 ジェネリクス：型安全なプログラミングの要

## 🎯総合演習プロジェクトへのステップ

前章で学んだコレクションは非常に強力ですが、それを安全に使うためには本章で学ぶ**ジェネリクス（Generics）** が不可欠です。総合演習プロジェクトでは、ジェネリクスを意識することが品質の基盤となります。

- **`ArrayList<Task>` の `<Task>` の意味**: `ArrayList`が、`Task`クラスのインスタンス「だけ」を格納することを保証するのがジェネリクスの役割です。これにより、誤って`String`や`Integer`をリストに追加してしまうといったミスを、コンパイル時点で防ぐことができます。
- **安全な型操作**: リストから要素を取り出す際に、`Task`型であることが保証されているため、面倒で危険なキャスト（型変換）が不要になります。

ジェネリクスを理解することは、コレクションを正しく使いこなし、堅牢で保守性の高いコードを書くための必須条件です。

## 📋 本章の学習目標

### 前提知識
- **第8章の知識**: `List`, `Set`, `Map`などのコレクションの基本的な使い方を理解している。

### 到達目標

#### 知識理解目標
- ジェネリクスが解決する課題（型安全性）を説明できる。
- `List<String>`のようなジェネリクスの基本的な構文を理解する。
- ダイヤモンド演算子（`<>`）の役割を理解する。

#### 技能習得目標
- ジェネリクスを使って、特定の型に限定されたコレクションを作成できる。
- ジェネリクスを利用して、安全にコレクションから要素を取り出し、利用できる。

---

## 9.1 なぜジェネリクスが必要なのか？

Java 5より前の時代、コレクションは「あらゆるオブジェクト」を格納できる`Object`型の入れ物でした。これは一見便利に思えますが、大きな問題を抱えていました。

```java
// ジェネリクスがなかった時代のコード（現在は非推奨）
List list = new ArrayList();
list.add("Hello");
list.add(123); // 文字列も数値も、何でも入ってしまう！

// 取り出すときに、本来の型を覚えておいて、キャストする必要がある
String message = (String) list.get(0); // OK
Integer number = (Integer) list.get(1); // OK

// もし間違った型で取り出そうとすると...
String wrong = (String) list.get(1); // コンパイルは通ってしまうが、実行時に ClassCastException が発生！
```

このように、コンパイラは型の誤りをチェックできず、バグが実行時まで発見されない危険な状態でした。

## 9.2 ジェネリクスによる型安全性

この問題を解決するためにJava 5で導入されたのが**ジェネリクス（Generics）** です。ジェネリクスは、コレクションなどのクラスが「どの型のデータ」を扱うのかを、**クラスを定義または利用する時点**で指定できるようにするしくみです。

`List<String>`のように、クラス名の後に山括弧`< >`で型を指定します。これを**型パラメータ**と呼びます。

```java
// String型の要素だけを格納できるListを宣言
List<String> stringList = new ArrayList<>();

stringList.add("Java");
// stringList.add(123); // コンパイルエラー！ String型以外は追加できない

// 取り出すときも、キャストは不要
String element = stringList.get(0); // 安全！
```

ジェネリクスを使うことで、コンパイラが型の整合性をチェックしてくれるため、意図しない型のデータが混入するのを防ぎ、プログラムの安全性を大幅に向上させることができます。

### ダイヤモンド演算子

Java 7からは、右辺の型パラメータを省略できる**ダイヤモンド演算子** (`<>`)が導入され、より簡潔に記述できるようになりました。コンパイラが左辺の宣言から型を推論してくれます。

```java
// Java 7以降の推奨される書き方
Map<String, List<Integer>> complexMap = new HashMap<>();
```

## まとめ

本章では、Javaの型安全性を支える重要な機能であるジェネリクスについて学びました。

-   **ジェネリクス**は、コレクションなどが扱うデータ型をコンパイル時に指定し、型の安全性を保証するしくみです。
-   これにより、実行時エラーである`ClassCastException`を未然に防ぐことができます。
-   `List<String>`のように型パラメータを指定し、ダイヤモンド演算子`<>`で記述を簡略化できます。

コレクションを扱う際には、必ずジェネリクスを使い、その恩恵を最大限に活用することが、現代的なJavaプログラミングの基本です。
