# 原稿修正プロトコル

## 目的
本プロトコルは、技術書「Java入門」の原稿修正作業において、品質を維持し、既存文章との調和を保ちながら、CLAUDE.mdのルールを遵守するための標準手順を定めるものです。

## 適用範囲
- `manuscripts/`ディレクトリ内の全ての.mdファイル
- 技術的説明の追加・修正・削除を伴う全ての作業

## 修正作業フロー

### Phase 1: 事前分析（必須）
1. **ルール確認**
   ```
   - docs/writing-guidelines-textlint-compliance.mdを必ず読み返す
   - CLAUDE.mdの現在の内容を確認
   - memories/manuscript-modification-checklistを参照
   - npm run check:compliance で現在の準拠状況を確認
   ```

2. **既存文章の詳細分析**
   ```
   - 対象章の全体を通読
   - 文体、トーン、説明深度を記録
   - 使用されている専門用語リストを作成
   ```

3. **修正計画の立案**
   ```
   - 修正の必要性と範囲を明確化
   - 既存文章への影響を評価
   - 最小限の修正で目的を達成する方法を検討
   ```

### Phase 2: 修正実施（段階的実行）
1. **小規模修正の原則**
   - 1回の修正は最大3段落まで
   - 大幅な追加は避け、既存文章の補強に留める
   - 文章の流れを断ち切らない

2. **文体統一の徹底**
   - 本文：ですます調（例外なし）
   - リスト項目：である調（意図的な使い分け）
   - 脚注：ですます調（リスト内でも例外）

3. **即時検証**
   - 各段落修正後に前後の文脈を確認
   - 不自然な接続がないかチェック

### Phase 3: 品質検証（省略不可）
1. **CLAUDE.mdルール準拠性検証（最優先）**
   ```bash
   npm run check:compliance
   ```
   - ルール違反が0件であることを確認
   - 新たな違反を導入していないことを確認

2. **textlint検証**
   ```bash
   npm run lint manuscripts/chapter[XX]-*.md
   ```
   - 新規エラーが0件であることを確認
   - 既存エラー数の増加がないことを確認

3. **読み返し検証**
   - 修正箇所の前後5段落を通読
   - 文章の自然な流れを確認
   - 説明レベルの一貫性を確認

4. **ルール適合性検証**
   - CLAUDE.mdの各項目との照合
   - チェックリストの全項目確認

### Phase 4: 報告と記録
1. **修正内容の記録**
   - 何を修正したか
   - なぜ修正したか
   - どのように既存文章と調和させたか

2. **検証結果の報告**
   - textlint結果
   - 文章調和性の評価
   - 今後の注意点

## 禁止事項
1. **絶対に行ってはいけないこと**
   - 既存文章の文脈を無視した大幅な追加
   - 対象読者レベルを超えた専門的内容の挿入
   - CLAUDE.mdルールを確認せずに修正を開始すること
   - textlint検証を省略すること

2. **避けるべきパターン**
   - 1つの章に10段落以上の追加
   - 既存の説明を置き換える形での修正
   - 前後の接続を考慮しない独立した内容の挿入

## エスカレーション
以下の場合は必ずユーザーに相談：
- 大幅な構造変更が必要と判断した場合
- 既存文章との調和が困難な場合
- CLAUDE.mdルールとの矛盾が発生した場合
- textlintエラーが解決できない場合

## 継続的改善
- 本プロトコルは定期的に見直し、改善する
- 失敗事例は必ず記録し、プロトコルに反映する
- ユーザーフィードバックを最優先で取り入れる

---
最終更新日: 2025-01-31