# 第17章 ネットワークプログラミング - 解答例

本ディレクトリには、第17章の課題に対する解答例が含まれています。

## 基礎レベル課題の解答

### 1. TCPエコーサーバー・クライアント
- **EchoServer.java**: マルチスレッド対応のTCPエコーサーバー
- **EchoClient.java**: 対話的なTCPエコークライアント

**実行方法：**
```bash
# サーバーを起動（別ターミナル）
javac EchoServer.java
java EchoServer [ポート番号]

# クライアントを起動
javac EchoClient.java
java EchoClient [ホスト名] [ポート番号]
```

**実装のポイント：**
- ExecutorServiceを使用した効率的なスレッド管理
- try-with-resourcesによる確実なリソース管理
- 適切なログ出力とエラーハンドリング
- シャットダウンフックによるグレースフルな終了

### 2. UDPチャットプログラム
※ 基礎課題のREADMEには記載されていますが、解答例は応用的な内容のため、ChatServer/ChatClientで代替しています。

### 3. 簡易HTTPクライアント
- **SimpleHttpClient.java**: ソケットベースのHTTPクライアント実装

**実行方法：**
```bash
javac SimpleHttpClient.java
java SimpleHttpClient http://example.com/
```

**実装のポイント：**
- HTTPプロトコルの手動実装
- リダイレクト（3xx）の自動追従
- Content-LengthとChunked転送エンコーディングの両方に対応
- 相対URLの適切な解決

### 4. ポートスキャナー
※ セキュリティの観点から、解答例には含めていません。実装する場合は必ず自分が管理するホストのみを対象とし、教育目的に限定してください。

## 応用レベル課題の解答

### 1. マルチクライアント対応チャットサーバー
- **ChatServer.java**: 高機能チャットサーバー
- **ChatClient.java**: 対応するチャットクライアント

**機能：**
- ユーザー認証とセッション管理
- 複数のチャットルーム
- プライベートメッセージ
- メッセージ履歴
- コマンドシステム（/help, /list, /join, /pm など）

**実行方法：**
```bash
# サーバーを起動
javac ChatServer.java
java ChatServer [ポート番号]

# クライアントを起動（複数起動可能）
javac ChatClient.java
java ChatClient [ホスト名] [ポート番号]
```

**実装の特徴：**
- ConcurrentHashMapによるスレッドセーフなデータ管理
- ExecutorServiceによる効率的な接続管理
- プロトコル設計（コマンドとメッセージの区別）
- ルームごとのメッセージ配信

## 学習のポイント

### 1. ソケットプログラミングの基礎
- ServerSocketとSocketの使い分け
- ブロッキングI/Oとタイムアウト設定
- 双方向通信の実装パターン

### 2. マルチスレッド処理
- スレッドプールの適切なサイジング
- 共有リソースへの安全なアクセス
- スレッドの適切な終了処理

### 3. プロトコル設計
- テキストベースプロトコルの利点と欠点
- コマンドとデータの区別
- エラーメッセージの設計

### 4. エラーハンドリング
- ネットワーク固有の例外処理
- 接続の異常終了への対処
- リソースリークの防止

## 発展的な学習

これらの解答例を基に、以下のような拡張を試みることができます：

1. **セキュリティの追加**
   - SSL/TLSによる暗号化通信
   - より堅牢な認証メカニズム

2. **パフォーマンスの向上**
   - NIOを使用した非同期I/O
   - より効率的なメッセージ配信

3. **機能の拡張**
   - ファイル転送機能
   - 音声/ビデオチャット
   - 永続的なメッセージストレージ

4. **プロトコルの改良**
   - バイナリプロトコルへの移行
   - 圧縮の実装
   - より効率的なシリアライゼーション

## 注意事項

- これらのコードは教育目的のサンプルです
- プロダクション環境では、より堅牢なエラー処理とセキュリティ対策が必要です
- ネットワークプログラミングでは、常にリソースの適切な管理を心がけてください