# 第18章 基本課題

## 🎯 学習目標
- GUIイベント処理の詳細理解（ActionEvent、MouseEvent等）
- リスナーパターンの実装と活用
- マウス・キーボード操作の処理
- カスタムコンポーネントの作成
- ドラッグ&ドロップ機能の実装
- イベント駆動プログラミングによるレスポンシブなUIデザイン

## 📝 課題一覧

### 課題1: マウスイベント処理システム
**ファイル名**: `MouseEventHandler.java`, `DrawingPanel.java`, `MouseEventTest.java`

マウスの様々なイベントを処理し、インタラクティブな描画アプリケーションを作成してください。

**要求仕様**:
- MouseListener、MouseMotionListener の実装
- マウスクリック、ドラッグ、移動の検出
- 座標情報の取得と表示
- 簡単な図形描画機能
- 右クリックメニューの実装

**実行例**:
```
=== マウスイベント処理システム ===
ウィンドウ表示: "Mouse Event Handler"
サイズ: 600x500ピクセル

描画パネル:
┌─────────────────────────────┐
│ [線] [四角] [円] [消去]      │ (ツールバー)
├─────────────────────────────┤
│ ┌─描画エリア───────────────┐  │
│ │          ●              │  │ (クリックした点)
│ │     ○                   │  │ (円)
│ │  ■─────■               │  │ (四角形)
│ │    ╲                   │  │ (線)
│ │     ╲___               │  │
│ └───────────────────────────┘  │
├─────────────────────────────┤
│ 座標: (245, 167) | ボタン: LEFT│ (ステータス)
└─────────────────────────────┘

マウスイベント検出:
1. マウス移動:
   座標更新: (245, 167)
   ステータス表示

2. 左クリック:
   位置: (100, 150)
   動作: 点を描画

3. ドラッグ開始 (mousePressed):
   開始位置: (50, 50)
   描画モード: 線描画開始

4. ドラッグ中 (mouseDragged):
   現在位置: (150, 100)
   プレビュー: リアルタイム線描画

5. ドラッグ終了 (mouseReleased):
   終了位置: (200, 150)
   完成: 線が確定

6. 右クリック:
   位置: (300, 200)
   表示: コンテキストメニュー
   ├── 元に戻す
   ├── やり直し
   ├── ──────
   ├── コピー
   ├── 貼り付け
   └── 削除

図形描画テスト:
線描画: (50,50) → (200,150)
四角形: 左上(100,100) 右下(200,200)
円描画: 中心(300,150) 半径50

ダブルクリック検出:
位置: (400, 300)
動作: 図形のプロパティ編集ダイアログ表示

マウス移動追跡:
開始: (0, 0)
移動距離: 245.3ピクセル
移動時間: 2.5秒
平均速度: 98.1 pixel/sec

コンソール出力:
Mouse moved: (245, 167)
Mouse clicked at: (100, 150) - LEFT button
Mouse dragged from: (50, 50) to: (150, 100)
Mouse released at: (200, 150)
Right click menu at: (300, 200)
```

**評価ポイント**:
- 複数のマウスイベントの適切な処理
- インタラクティブな描画機能
- ユーザビリティの考慮

---

### 課題2: キーボードイベント処理システム
**ファイル名**: `KeyboardEventHandler.java`, `TextInputPanel.java`, `KeyboardEventTest.java`

キーボードイベントを処理し、高度なテキスト入力機能を実装してください。

**要求仕様**:
- KeyListener の実装
- 特殊キー（Ctrl、Alt、Shift）の組み合わせ検出
- ショートカットキーの実装
- テキスト入力の制御（数値のみ、文字数制限等）
- カスタムキーマッピング

**実行例**:
```
=== キーボードイベント処理システム ===
ウィンドウ表示: "Keyboard Event Handler"
サイズ: 500x400ピクセル

テキスト入力パネル:
┌─────────────────────────────┐
│ 入力フィールド:              │
│ [Hello, Java World!_____]   │ (カーソル)
├─────────────────────────────┤
│ 数値専用フィールド:          │
│ [12345________________]     │
├─────────────────────────────┤
│ パスワードフィールド:        │
│ [●●●●●●●●______________]     │
├─────────────────────────────┤
│ キー情報表示エリア           │
│ 最後に押されたキー: 'o'      │
│ キーコード: 79              │
│ 修飾キー: なし              │
└─────────────────────────────┘

キーイベント検出:
1. 通常文字入力:
   キー: 'H' (keyCode: 72)
   動作: 文字追加

2. 特殊キー:
   キー: Enter (keyCode: 10)
   動作: 改行または実行

   キー: Backspace (keyCode: 8)
   動作: 文字削除

   キー: Delete (keyCode: 127)
   動作: カーソル位置の文字削除

3. 修飾キー組み合わせ:
   Ctrl + A: 全選択
   Ctrl + C: コピー
   Ctrl + V: 貼り付け
   Ctrl + Z: 元に戻す
   Shift + 矢印: テキスト選択

4. ファンクションキー:
   F1: ヘルプ表示
   F5: 更新
   F11: フルスクリーン切り替え

入力制御テスト:
数値専用フィールド:
入力: "123abc" → 表示: "123"
説明: 非数値文字は自動除外

パスワードフィールド:
入力: "password" → 表示: "●●●●●●●●"
セキュリティ: 文字は隠蔽表示

文字数制限フィールド (10文字):
入力: "Hello, World!" → 表示: "Hello, Wor"
制限: 10文字を超えた分は無視

ショートカットキー一覧:
Ctrl + N: 新規作成
Ctrl + O: ファイルを開く
Ctrl + S: 保存
Ctrl + F: 検索
Ctrl + H: 置換
Alt + F4: アプリケーション終了

カスタムキーマッピング:
F2: 名前変更モード
Esc: キャンセル
Space: 一時停止/再開
Tab: 次のフィールドへ移動

キー入力統計:
総キーストローク数: 156
入力速度: 45 WPM (Words Per Minute)
エラー修正回数: 12回
最も使用されたキー: 'e' (23回)

コンソール出力:
Key pressed: 'H' (72)
Key combination: Ctrl+C
Text selected and copied
Key pressed: Enter (10)
Action executed: Submit form
```

**評価ポイント**:
- キーボードイベントの包括的な処理
- ショートカットキーシステムの実装
- 入力制御とバリデーション

---

### 課題3: カスタムコンポーネント作成
**ファイル名**: `CustomSlider.java`, `ColorPicker.java`, `ProgressIndicator.java`, `CustomComponentTest.java`

独自のGUIコンポーネントを作成し、再利用可能なライブラリを構築してください。

**要求仕様**:
- JComponent を継承したカスタムコンポーネント
- カスタム描画（paintComponent のオーバーライド）
- プロパティとイベントの実装
- アニメーション効果
- 設定可能な外観とテーマ

**実行例**:
```
=== カスタムコンポーネント作成 ===
ウィンドウ表示: "Custom Components Demo"
サイズ: 700x600ピクセル

カスタムスライダー:
┌─────────────────────────────┐
│ 音量調整                     │
│ ├──────●─────┤ 75%         │ (カスタムスライダー)
│                             │
│ 明度調整                     │
│ ├───●────────┤ 40%         │ (カスタムスライダー)
└─────────────────────────────┘

カラーピッカー:
┌─────────────────────────────┐
│ ┌─色相環─────┐ ┌─明度─┐    │
│ │     ●     │ │  ●  │    │
│ │ ○────┼──○ │ │     │    │
│ │     ○     │ │     │    │
│ └───────────┘ └─────┘    │
│                             │
│ 選択色: RGB(255, 128, 64)    │
│ HEX: #FF8040                │
└─────────────────────────────┘

プログレスインジケーター:
┌─────────────────────────────┐
│ タスク進行状況:              │
│                             │
│ ●○○○○○○○○○ 10%           │ (点状インジケーター)
│                             │
│ ████████░░░░░░░░ 40%        │ (バー型インジケーター)
│                             │
│ ⟲ 処理中... 65%            │ (回転型インジケーター)
└─────────────────────────────┘

コンポーネント機能テスト:

カスタムスライダー:
- ドラッグによる値変更: 0-100%
- クリックによるジャンプ移動
- キーボード操作対応 (矢印キー)
- 値変更イベント発生
- カスタム描画: グラデーション効果

カラーピッカー:
- マウスドラッグによる色選択
- HSV色空間での色変更
- RGB/HEX表示の自動更新
- 色変更イベント発生
- プリセットカラーのクイック選択

プログレスインジケーター:
- 進行状況の視覚的表示
- 異なる表示スタイル (点、バー、回転)
- スムーズなアニメーション
- 色とサイズのカスタマイズ
- 完了通知イベント

アニメーション効果:
開始時間: 2024-07-04 10:30:00
現在進行: 65%
残り時間: 35秒
アニメーション: フェードイン/アウト

テーマ設定:
デフォルトテーマ: 青系グラデーション
ダークテーマ: 黒系グラデーション
カスタムテーマ: ユーザー定義色

プロパティ設定例:
customSlider.setMinimum(0);
customSlider.setMaximum(100);
customSlider.setValue(75);
customSlider.setOrientation(HORIZONTAL);

colorPicker.setSelectedColor(Color.ORANGE);
colorPicker.setShowAlpha(true);

progressIndicator.setProgress(65);
progressIndicator.setStyle(CIRCULAR);
progressIndicator.setAnimated(true);

イベントリスナー:
スライダー値変更: 75% → 音量調整実行
色選択変更: #FF8040 → 背景色変更
進行状況更新: 65% → ステータス更新
```

**評価ポイント**:
- オリジナルコンポーネントの設計
- カスタム描画の実装
- イベントシステムの構築

---

### 課題4: ドラッグ&ドロップファイルマネージャー
**ファイル名**: `DragDropFileManager.java`, `FileTransferHandler.java`, `DragDropTest.java`

ドラッグ&ドロップ機能を実装したファイルマネージャーを作成してください。

**要求仕様**:
- TransferHandler による D&D 実装
- ファイル・フォルダのドラッグ&ドロップ
- 外部アプリケーションとのデータ交換
- ドロップ領域の視覚的フィードバック
- ファイル操作（コピー、移動、削除）

**実行例**:
```
=== ドラッグ&ドロップファイルマネージャー ===
ウィンドウ表示: "Drag & Drop File Manager"
サイズ: 800x600ピクセル

ファイルマネージャー画面:
┌─────────────────────────────┐
│ [←] [→] [↑] C:\Users\       │ (ナビゲーション)
├─────────────────────────────┤
│ ┌─フォルダツリー─┐ ┌─ファイル一覧─┐ │
│ │ ├📁 Documents │ │ 📄 file1.txt │ │
│ │ ├📁 Pictures  │ │ 📄 file2.java│ │
│ │ ├📁 Music     │ │ 📁 folder1   │ │
│ │ └📁 Downloads │ │ 📷 image.jpg │ │
│ └──────────────┘ └─────────────┘ │
├─────────────────────────────┤
│ ┌─ドロップ領域─────────────┐   │
│ │ ここにファイルをドロップ │   │
│ │ [    📎 拡張子対応    ] │   │
│ └───────────────────────────┘   │
└─────────────────────────────┘

ドラッグ&ドロップ操作:

1. ファイルリストからドラッグ開始:
   ファイル: file1.txt
   表示: ドラッグカーソル + ファイルアイコン
   状態: ドラッグ開始

2. フォルダへドロップ:
   ドロップ先: Documents フォルダ
   動作: ファイル移動
   確認: 「file1.txtをDocumentsに移動しますか？」
   結果: 移動完了

3. 外部からのドラッグ&ドロップ:
   ソース: エクスプローラー
   ファイル: C:\temp\image.jpg
   ドロップ先: ドロップ領域
   動作: ファイルコピー

4. 複数ファイルの一括操作:
   選択: file1.txt, file2.java, image.jpg
   ドラッグ: 3ファイル同時
   ドロップ: Downloads フォルダ
   進行状況表示: 「3ファイルをコピー中... 67%」

ドロップ領域の視覚的フィードバック:
通常状態: 薄い灰色背景
ドラッグオーバー: 青色ハイライト
ドロップ可能: 緑色枠線
ドロップ不可: 赤色枠線 + 禁止アイコン

サポートするファイル形式:
📄 テキストファイル: .txt, .java, .html
📷 画像ファイル: .jpg, .png, .gif
🎵 音楽ファイル: .mp3, .wav
📁 フォルダ: 任意のディレクトリ

ファイル操作機能:
右クリックメニュー:
├── 開く
├── 編集
├── ─────────
├── 切り取り (Ctrl+X)
├── コピー (Ctrl+C)
├── 貼り付け (Ctrl+V)
├── ─────────
├── 削除 (Delete)
├── 名前の変更 (F2)
└── プロパティ

ドラッグ&ドロップ統計:
セッション開始: 2024-07-04 10:30:00
ドラッグ操作回数: 15回
ドロップ成功: 12回
ドロップ失敗: 3回
転送データ量: 45.6MB
平均転送速度: 12.3MB/s

データ転送タイプ:
COPY: ファイルをコピー (Ctrl+ドラッグ)
MOVE: ファイルを移動 (通常ドラッグ)
LINK: ショートカット作成 (Alt+ドラッグ)

エラーハンドリング:
アクセス権限エラー: 読み取り専用ファイル
ディスク容量不足: 空き容量チェック
ファイル名重複: 自動リネーム提案
不正なファイル形式: フィルタリング

コンソール出力:
Drag started: file1.txt
Drag over: Documents folder
Drop completed: MOVE operation
Transfer successful: 1 file(s) moved
```

**評価ポイント**:
- TransferHandler の高度な活用
- 複雑なファイル操作の実装
- ユーザビリティの高いインターフェース

## 💡 ヒント

### 課題1のヒント
- MouseAdapter で必要なメソッドのみオーバーライド
- getX(), getY() で座標取得
- SwingUtilities.isRightMouseButton() で右クリック判定

### 課題2のヒント
- KeyEvent.getKeyCode() でキーコード取得
- KeyEvent.isControlDown() で修飾キー判定
- DocumentFilter でテキスト入力制御

### 課題3のヒント
- paintComponent() で独自描画
- Graphics2D でアンチエイリアス等の高品質描画
- Timer でアニメーション実装

### 課題4のヒント
- TransferHandler.TransferSupport でドロップ判定
- DataFlavor でデータ形式指定
- JComponent.setDropTarget() でドロップ受け入れ設定

## 🔍 イベント処理のポイント

1. **イベントリスナー**: 適切なリスナーインターフェースの選択
2. **イベント委譲**: Event Dispatch Thread での処理
3. **カスタム描画**: Graphics2D による高品質レンダリング
4. **ドラッグ&ドロップ**: TransferHandler による柔軟なデータ転送
5. **パフォーマンス**: 重い処理の別スレッド実行
6. **ユーザビリティ**: 直感的な操作性の実現

## ✅ 完了チェックリスト

- [ ] 課題1: マウスイベントを適切に処理できている
- [ ] 課題2: キーボードイベントとショートカットが実装できている
- [ ] 課題3: カスタムコンポーネントが作成できている
- [ ] 課題4: ドラッグ&ドロップ機能が実装できている
- [ ] 複雑なイベント処理システムを理解している
- [ ] ユーザビリティの高いGUIが設計できている

**次のステップ**: 基本課題が完了したら、advanced/の発展課題でより高度なイベント処理に挑戦しましょう！